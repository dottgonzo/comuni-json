"use strict";
var _ = require("lodash");
var geo = require("geolib");
var world = require("./world.json");
var Localize = (function () {
    function Localize() {
    }
    Localize.prototype.getPosition = function (o) {
        if (!(o && o.latitude && o.longitude))
            throw Error("Error");
        var pos = { latitude: o.latitude, longitude: o.longitude };
        var _this = this;
        var State;
        if (o.state && _this.getState(o.state)) {
            State = _this.getState(o.state);
            console.log('ss');
        }
        else {
            console.log('todo');
            throw Error("todo");
        }
        var allprovinces = _this.getProvincesFromState(State.name);
        _.map(allprovinces, function (c) {
            c.distance = geo.getDistance({ latitude: c.latitude, longitude: c.longitude }, pos);
        });
        var reprov = _.take(_.orderBy(allprovinces, ['distance'], ['asc']), 2);
        var provinces = [];
        _.map(reprov, function (c) {
            _.map(_this.getProvinceFromCity(c.nativeName, State.name), function (p) {
                p.distance = geo.getDistance({ latitude: p.latitude, longitude: p.longitude }, pos);
                provinces.push(p);
            });
        });
        var cities = _.take(_.orderBy(provinces, ['distance'], ['asc']), 2);
        if (cities[0].distance * 1.4 > cities[0].distance) {
            cities = [cities[0]];
        }
        return cities;
    };
    Localize.prototype.getLocation = function (o) {
        return true;
    };
    Localize.prototype.getinfo = function (o) {
        return true;
    };
    Localize.prototype.getState = function (state, o) {
        var exists = false;
        var answer;
        _.map(world, function (continent) {
            _.map(continent.subcontinents, function (subcontinent) {
                _.map(subcontinent.countries, function (country) {
                    _.map(country.states, function (s) {
                        console.log(s.name);
                        if (s.name === state) {
                            exists = true;
                            answer = s;
                        }
                    });
                    if (!exists) {
                        answer = false;
                    }
                });
            });
        });
        return answer;
    };
    Localize.prototype.getProvincesFromState = function (state) {
        var _this = this;
        var State;
        if (state) {
            State = _this.getState(state);
        }
        else {
            throw Error("todo");
        }
        var provinces = [];
        _.map(State.regions, function (r) {
            _.map(r.cities, function (c) {
                provinces.push(c);
            });
        });
        return provinces;
    };
    Localize.prototype.getProvinceFromCity = function (city, state) {
        var _this = this;
        var State;
        if (state) {
            State = _this.getState(state);
        }
        else {
            throw Error("todo");
        }
        var provinces = [];
        _.map(State.regions, function (r) {
            _.map(r.provinces, function (p) {
                if (p.main.nativeName === city) {
                    _.map(p.cities, function (c) {
                        provinces.push(c);
                    });
                }
            });
        });
        return provinces;
    };
    return Localize;
}());
Object.defineProperty(exports, "__esModule", { value: true });
exports.default = Localize;

//# sourceMappingURL=data:application/json;base64,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QUFFLFVBQVUsQ0FBQztZQUM1QixDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDO2dCQUMxQixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDO29CQUM3QixDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDO3dCQUV2QixTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFBO29CQUdyQixDQUFDLENBQUMsQ0FBQTtnQkFDTixDQUFDO1lBR0wsQ0FBQyxDQUFDLENBQUE7UUFFTixDQUFDLENBQUMsQ0FBQTtRQUdGLE1BQU0sQ0FBQyxTQUFTLENBQUE7SUFFcEIsQ0FBQztJQUVMLGVBQUM7QUFBRCxDQTdLQSxBQTZLQyxJQUFBO0FBN0tEOzBCQTZLQyxDQUFBIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgXyBmcm9tIFwibG9kYXNoXCI7XG5cbmxldCBnZW8gPSByZXF1aXJlKFwiZ2VvbGliXCIpO1xuXG5pbnRlcmZhY2UgSUJvdW5kYXJ5IHtcblxuICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgbG9uZ2l0dWRlOiBudW1iZXI7XG5cbn1cblxuaW50ZXJmYWNlIElHZW9jb2RlcyB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHByb3ZpbmNlczogSUdlb1tdO1xuICAgIGNpdGllczogSUNpdHlbXVxufVxuXG5cblxuaW50ZXJmYWNlIElDaXR5IHtcbiAgICBuYXRpdmVOYW1lOiBzdHJpbmc7XG4gICAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgICBsb25naXR1ZGU6IG51bWJlcjtcbiAgICB6aXBjb2RlOiBudW1iZXI7XG4gICAgY2l0eUNvZGU6IHN0cmluZztcbiAgICBzdGF0ZTogc3RyaW5nO1xuICAgIGNvdW50cnk6IHN0cmluZztcbiAgICBpc29MYW5nOiBzdHJpbmc7XG4gICAgdHo6IHN0cmluZztcbiAgICBjdXJyZW5jeTogc3RyaW5nO1xuICAgIGN1cnJlbmN5U3ltYm9sOiBzdHJpbmc7XG4gICAgZGlzdGFuY2U/OiBudW1iZXI7XG4gICAgc3ViY29udGluZW50OnN0cmluZztcbiAgICBjb250aW5lbnQ6c3RyaW5nO1xuICAgIHJlZ2lvbjpzdHJpbmc7XG59XG5cbmludGVyZmFjZSBJR2VvIHtcbiAgICBuYXRpdmVOYW1lOiBzdHJpbmc7XG4gICAgemlwY29kZTogc3RyaW5nO1xuICAgIGNpdGllczogSUNpdHlbXTtcbiAgICBtYWluOiBJQ2l0eTtcbiAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuXG59XG5cblxuaW50ZXJmYWNlIElzdGF0ZSB7XG4gICAgcmVnaW9uczogSUdlb2NvZGVzW107XG4gICAgYm91bmRhcmllczogSUJvdW5kYXJ5W107XG4gICAgY2FwaXRhbDogSUNpdHk7XG4gICAgbmF0aXZlTmFtZTogc3RyaW5nO1xuICAgIGxhdGxuZzogbnVtYmVyW107XG4gICAgaXNvTGFuZzogc3RyaW5nW107XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHR6OiBzdHJpbmc7XG4gICAgY291bnRyeTpzdHJpbmc7XG4gICAgc3ViY29udGluZW50OnN0cmluZztcbiAgICBjb250aW5lbnQ6c3RyaW5nO1xuXG59XG5cbmludGVyZmFjZSBJQ291bnRyeSB7XG4gICAgc3RhdGVzOiBJc3RhdGVbXTtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgYm91bmRhcmllczogSUJvdW5kYXJ5W107XG4gICAgbmF0aXZlTmFtZTogc3RyaW5nO1xuICAgIGNhcGl0YWw6IElDaXR5O1xuICAgIGN1cnJlbmNpZXM6IHN0cmluZ1tdO1xuICAgIGlzb0xhbmc6IHN0cmluZ1tdO1xuICAgIGxhdGxuZzogbnVtYmVyW107XG4gICAgdHo6IHN0cmluZztcbiAgICBzdWJjb250aW5lbnQ6c3RyaW5nO1xuICAgIGNvbnRpbmVudDpzdHJpbmc7XG5cbn1cblxuaW50ZXJmYWNlIElTdWJjb250aW5lbnQge1xuXG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGNvdW50cmllczogSUNvdW50cnlbXTtcbiAgICBib3VuZGFyaWVzOiBJQm91bmRhcnlbXTtcbiAgICBjb250aW5lbnQ6c3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgSUdlb2J1aWxkIHtcblxuICAgIG5hbWU6IHN0cmluZztcbiAgICBzdWJjb250aW5lbnRzOiBJU3ViY29udGluZW50W107XG4gICAgYm91bmRhcmllczogSUJvdW5kYXJ5W107XG5cbn1cblxuXG5cbmxldCB3b3JsZDogSUdlb2J1aWxkW10gPSByZXF1aXJlKFwiLi93b3JsZC5qc29uXCIpO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMb2NhbGl6ZSB7XG5cbiAgICBnZXRQb3NpdGlvbihvOiB7IGxhdGl0dWRlOiBudW1iZXIsIGxvbmdpdHVkZTogbnVtYmVyLCBzdGF0ZT86IHN0cmluZyB9KSB7XG5cbiAgICAgICAgaWYgKCEobyAmJiBvLmxhdGl0dWRlICYmIG8ubG9uZ2l0dWRlKSkgdGhyb3cgRXJyb3IoXCJFcnJvclwiKTtcblxuICAgICAgICBsZXQgcG9zID0geyBsYXRpdHVkZTogby5sYXRpdHVkZSwgbG9uZ2l0dWRlOiBvLmxvbmdpdHVkZSB9O1xuXG4gICAgICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGxldCBTdGF0ZTogSXN0YXRlO1xuICAgICAgICBpZiAoby5zdGF0ZSAmJiBfdGhpcy5nZXRTdGF0ZShvLnN0YXRlKSkge1xuICAgICAgICAgICAgU3RhdGUgPSA8SXN0YXRlPl90aGlzLmdldFN0YXRlKG8uc3RhdGUpXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc3MnKTtcblxuXG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0b2RvJyk7XG5cbiAgICAgICAgICAgIHRocm93IEVycm9yKFwidG9kb1wiKTtcblxuXG4gICAgICAgIH1cblxuXG4gICAgICAgIC8vIGxpdmVsbG8gbmF6aW9uYWxlXG4gICAgICAgIGxldCBhbGxwcm92aW5jZXMgPSBfdGhpcy5nZXRQcm92aW5jZXNGcm9tU3RhdGUoU3RhdGUubmFtZSk7XG5cblxuICAgICAgICBfLm1hcChhbGxwcm92aW5jZXMsIGZ1bmN0aW9uIChjKSB7XG4gICAgICAgICAgICBjLmRpc3RhbmNlID0gZ2VvLmdldERpc3RhbmNlKHsgbGF0aXR1ZGU6IGMubGF0aXR1ZGUsIGxvbmdpdHVkZTogYy5sb25naXR1ZGUgfSwgcG9zKTtcblxuICAgICAgICB9KVxuXG5cblxuXG4gICAgICAgIGxldCByZXByb3YgPSBfLnRha2UoXy5vcmRlckJ5KGFsbHByb3ZpbmNlcywgWydkaXN0YW5jZSddLCBbJ2FzYyddKSwgMik7XG5cbiAgICAgICAgbGV0IHByb3ZpbmNlcyA9IFtdO1xuICAgICAgICBfLm1hcChyZXByb3YsIGZ1bmN0aW9uIChjOiBJQ2l0eSkge1xuXG4gICAgICAgICAgICBfLm1hcChfdGhpcy5nZXRQcm92aW5jZUZyb21DaXR5KGMubmF0aXZlTmFtZSwgU3RhdGUubmFtZSksIGZ1bmN0aW9uIChwKSB7XG4gICAgICAgICAgICAgICAgcC5kaXN0YW5jZSA9IGdlby5nZXREaXN0YW5jZSh7IGxhdGl0dWRlOiBwLmxhdGl0dWRlLCBsb25naXR1ZGU6IHAubG9uZ2l0dWRlIH0sIHBvcyk7XG5cbiAgICAgICAgICAgICAgICBwcm92aW5jZXMucHVzaChwKVxuICAgICAgICAgICAgfSlcblxuICAgICAgICB9KVxuXG5cbiAgICAgICAgbGV0IGNpdGllczogSUNpdHlbXSA9IDxJQ2l0eVtdPl8udGFrZShfLm9yZGVyQnkocHJvdmluY2VzLCBbJ2Rpc3RhbmNlJ10sIFsnYXNjJ10pLCAyKTtcblxuICAgICAgICBpZiAoY2l0aWVzWzBdLmRpc3RhbmNlICogMS40ID4gY2l0aWVzWzBdLmRpc3RhbmNlKSB7XG4gICAgICAgICAgICBjaXRpZXMgPSBbY2l0aWVzWzBdXVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNpdGllc1xuXG5cbiAgICB9XG5cblxuICAgIGdldExvY2F0aW9uKG86IHsgY2l0eTogc3RyaW5nLCBzdGF0ZT86IHN0cmluZyB9KSB7XG4gICAgICAgIHJldHVybiB0cnVlXG5cbiAgICB9XG5cbiAgICBnZXRpbmZvKG86IHsgY2l0eTogc3RyaW5nLCBzdGF0ZT86IHN0cmluZyB9KSB7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgZ2V0U3RhdGUoc3RhdGU6IHN0cmluZywgbz86IHsgY29udGluZW50Pzogc3RyaW5nIH0pOiBJc3RhdGUgfCBib29sZWFuIHtcblxuXG4gICAgICAgIGxldCBleGlzdHMgPSBmYWxzZTtcblxuICAgICAgICBsZXQgYW5zd2VyO1xuXG4gICAgICAgIF8ubWFwKHdvcmxkLCBmdW5jdGlvbiAoY29udGluZW50KSB7XG5cbiAgICAgICAgICAgIF8ubWFwKGNvbnRpbmVudC5zdWJjb250aW5lbnRzLCBmdW5jdGlvbiAoc3ViY29udGluZW50KSB7XG5cbiAgICAgICAgICAgICAgICBfLm1hcChzdWJjb250aW5lbnQuY291bnRyaWVzLCBmdW5jdGlvbiAoY291bnRyeSkge1xuXG4gICAgICAgICAgICAgICAgICAgIF8ubWFwKGNvdW50cnkuc3RhdGVzLCBmdW5jdGlvbiAocykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocy5uYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHMubmFtZSA9PT0gc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuc3dlciA9IHNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFleGlzdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuc3dlciA9IGZhbHNlXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfSlcblxuXG4gICAgICAgIHJldHVybiBhbnN3ZXJcblxuICAgIH1cblxuICAgIGdldFByb3ZpbmNlc0Zyb21TdGF0ZShzdGF0ZSkge1xuXG4gICAgICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGxldCBTdGF0ZTogSXN0YXRlO1xuXG4gICAgICAgIGlmIChzdGF0ZSkge1xuICAgICAgICAgICAgU3RhdGUgPSA8SXN0YXRlPl90aGlzLmdldFN0YXRlKHN0YXRlKVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInRvZG9cIik7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBwcm92aW5jZXM6IElDaXR5W10gPSBbXTtcbiAgICAgICAgXy5tYXAoU3RhdGUucmVnaW9ucywgZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIF8ubWFwKHIuY2l0aWVzLCBmdW5jdGlvbiAoYykge1xuXG4gICAgICAgICAgICAgICAgcHJvdmluY2VzLnB1c2goYylcblxuICAgICAgICAgICAgfSlcblxuICAgICAgICB9KVxuXG5cbiAgICAgICAgcmV0dXJuIHByb3ZpbmNlc1xuXG4gICAgfVxuXG4gICAgZ2V0UHJvdmluY2VGcm9tQ2l0eShjaXR5LCBzdGF0ZT86IHN0cmluZykge1xuXG4gICAgICAgIGxldCBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGxldCBTdGF0ZTogSXN0YXRlO1xuXG4gICAgICAgIGlmIChzdGF0ZSkge1xuICAgICAgICAgICAgU3RhdGUgPSA8SXN0YXRlPl90aGlzLmdldFN0YXRlKHN0YXRlKVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInRvZG9cIik7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBwcm92aW5jZXM6IElDaXR5W10gPSBbXTtcbiAgICAgICAgXy5tYXAoU3RhdGUucmVnaW9ucywgZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIF8ubWFwKHIucHJvdmluY2VzLCBmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgICAgIGlmIChwLm1haW4ubmF0aXZlTmFtZSA9PT0gY2l0eSkge1xuICAgICAgICAgICAgICAgICAgICBfLm1hcChwLmNpdGllcywgZnVuY3Rpb24gKGMpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvdmluY2VzLnB1c2goYylcblxuXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfSlcblxuXG4gICAgICAgIHJldHVybiBwcm92aW5jZXNcblxuICAgIH1cblxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==

"use strict";
var Comuni = require("./comuni.json");
var _ = require("lodash");
var async = require("async");
var fs = require("fs");
var geocoder = require("search-google-geocode");
var options = {
    language: 'it'
};
var all = Comuni;
var test = [all[0], all[3], all[4]];
var use = all;
async.eachSeries(use, function (iterate, cb) {
    function callbackGeo(error, result) {
        if (error) {
            console.log(error);
            cb();
        }
        else {
            if (result && result.length && result[0]) {
                _.map(Object.keys(result[0]), function (k) {
                    iterate[k] = result[0][k];
                });
                fs.writeFile("./comuni.json", JSON.stringify(use), { encoding: "utf-8" }, function (err) {
                    if (error) {
                        console.log(error);
                    }
                    else {
                    }
                    cb();
                });
                console.log("ok " + iterate.nome + " " + iterate.sigla);
            }
            else {
                console.warn("WARN " + iterate.nome + " " + iterate.sigla);
                cb();
            }
        }
        ;
    }
    if (!iterate.latitude) {
        geocoder.geocode(iterate.nome, callbackGeo, options);
    }
    else {
        console.log("exists " + iterate.nome);
        cb();
    }
}, function (err) {
    if (err) {
    }
    else {
        console.log("ok");
    }
});

//# sourceMappingURL=data:application/json;base64,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RUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUVWLENBQUM7SUFBQyxJQUFJLENBQUMsQ0FBQztRQUNKLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDckIsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFBIiwiZmlsZSI6ImFkZENvb3Jkcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImludGVyZmFjZSBJQ29tdW5lIHtcbiAgICBub21lOiBzdHJpbmc7XG4gICAgY29kaWNlOiBudW1iZXI7XG4gICAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgICBsb25naXR1ZGU6IG51bWJlcjtcbiAgICB6b25hOiB7XG4gICAgICAgIG5vbWU6IHN0cmluZztcbiAgICAgICAgY29kaWNlOiBudW1iZXI7XG4gICAgfSxcbiAgICByZWdpb25lOiB7XG4gICAgICAgIGNvZGljZTogbnVtYmVyO1xuICAgICAgICBub21lOiBzdHJpbmc7XG4gICAgfSxcbiAgICBjbToge1xuICAgICAgICBjb2RpY2U6IHN0cmluZztcbiAgICAgICAgbm9tZTogc3RyaW5nO1xuICAgIH0sXG4gICAgcHJvdmluY2lhOiB7XG4gICAgICAgIGNvZGljZTogbnVtYmVyO1xuICAgICAgICBub21lOiBzdHJpbmc7XG4gICAgfSxcbiAgICBzaWdsYTogc3RyaW5nO1xuICAgIGNvZGljZUNhdGFzdGFsZTogc3RyaW5nO1xuICAgIGNhcDogbnVtYmVyO1xufVxuXG5cblxubGV0IENvbXVuaTogSUNvbXVuZVtdID0gcmVxdWlyZShcIi4vY29tdW5pLmpzb25cIik7XG5cbmltcG9ydCAqIGFzIF8gZnJvbSBcImxvZGFzaFwiO1xuaW1wb3J0ICogYXMgYXN5bmMgZnJvbSBcImFzeW5jXCI7XG5pbXBvcnQgKiBhcyBmcyBmcm9tIFwiZnNcIjtcblxubGV0IGdlb2NvZGVyID0gcmVxdWlyZShcInNlYXJjaC1nb29nbGUtZ2VvY29kZVwiKTtcbi8vIHlvdSBjYW4gdXNlIEdvb2dsZSBvcHRpb25zIHRvIG1hbmFnZSByZXN1bHQgZm9ybWF0IFxudmFyIG9wdGlvbnMgPSB7XG4gICAgbGFuZ3VhZ2U6ICdpdCdcbn07XG5jb25zdCBhbGwgPSBDb211bmk7XG5jb25zdCB0ZXN0ID0gW2FsbFswXSwgYWxsWzNdLCBhbGxbNF1dXG5cbi8vIHVzZSBjYWxsYmFjayB0byByZXR1cm4gcmVzdWx0IGZyb20gZ2VvY29kaW5nIHByb2Nlc3NcblxuY29uc3QgdXNlID0gYWxsO1xuXG4vLyBhZGRyZXNzIGdlb2NvZGluZ1xuLy8gcmV2ZXJzZSBnZW9jb2RpbmdcbmFzeW5jLmVhY2hTZXJpZXModXNlLCBmdW5jdGlvbiAoaXRlcmF0ZSwgY2IpIHtcblxuXG4gICAgZnVuY3Rpb24gY2FsbGJhY2tHZW8oZXJyb3IsIHJlc3VsdCkge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxuICAgICAgICAgICAgY2IoKVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5sZW5ndGggJiYgcmVzdWx0WzBdKSB7XG4gICAgICAgICAgICAgICAgXy5tYXAoT2JqZWN0LmtleXMocmVzdWx0WzBdKSwgZnVuY3Rpb24gKGspIHtcbiAgICAgICAgICAgICAgICAgICAgaXRlcmF0ZVtrXSA9IHJlc3VsdFswXVtrXVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgZnMud3JpdGVGaWxlKFwiLi9jb211bmkuanNvblwiLCBKU09OLnN0cmluZ2lmeSh1c2UpLCB7IGVuY29kaW5nOiBcInV0Zi04XCIgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNiKClcblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJvayBcIiArIGl0ZXJhdGUubm9tZSArIFwiIFwiICsgaXRlcmF0ZS5zaWdsYSlcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJXQVJOIFwiICsgaXRlcmF0ZS5ub21lICsgXCIgXCIgKyBpdGVyYXRlLnNpZ2xhKVxuICAgICAgICAgICAgICAgIGNiKClcblxuICAgICAgICAgICAgfVxuICAgICAgICB9OyAvLyBvbiBzdWNjZXNzXG4gICAgfVxuXG5cbiAgICBpZiAoIWl0ZXJhdGUubGF0aXR1ZGUpIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZygndG9kbyAnK2Mubm9tZSk7XG4gICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoaXRlcmF0ZS5ub21lLCBjYWxsYmFja0dlbywgb3B0aW9ucyk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhcImV4aXN0cyBcIiArIGl0ZXJhdGUubm9tZSlcbiAgICAgICAgY2IoKVxuXG4gICAgfVxuXG5cbn0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICBpZiAoZXJyKSB7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhcIm9rXCIpXG4gICAgfVxufSlcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==

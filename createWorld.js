"use strict";
var fs = require("fs");
var _ = require("lodash");
var Comuni = require("./comuni.json");
var Regioni = require("./regioni.json");
var countries = require("countryjs");
var Countries = countries.all();
var all = Countries;
var tests = [all[0], all[1]];
var use = tests;
var Geobuilds = [];
var continents = [];
_.map(use, function (countryjs) {
    var continent_exists = false;
    var capital;
    var country = { tz: "", capital: capital, latlng: countryjs.latlng, nativeName: countryjs.nativeName, name: countryjs.name, states: [], boundaries: [], currencies: countryjs.currencies, isoLang: countryjs.languages };
    if (country.name === "Afghanistan") {
        _.map(Regioni, function (p) {
            _.map(p.cities, function (t) {
                if (t.nativeName === "Roma") {
                    console.log("Roma");
                    country.states.push({
                        name: country.name,
                        nativeName: country.nativeName,
                        latlng: country.latlng,
                        regions: Regioni,
                        boundaries: [],
                        capital: t,
                        isoLang: country.isoLang,
                        tz: country.tz
                    });
                }
            });
        });
    }
    var subcontinent = { name: countryjs.subregion, countries: [country], boundaries: [] };
    var continent = { name: countryjs.region, subcontinents: [subcontinent], boundaries: [] };
    _.map(continents, function (cont) {
        var subcontinent_exists = false;
        if (cont.name === continent.name) {
            continent_exists = true;
            _.map(cont.subcontinents, function (sub) {
                if (sub.name === subcontinent.name) {
                    subcontinent_exists = true;
                    var country_exists_1 = false;
                    _.map(sub.countries, function (co) {
                        if (co.name === country.name) {
                            country_exists_1 = true;
                        }
                    });
                    if (!country_exists_1) {
                        subcontinent.countries.push(country);
                    }
                }
            });
            if (!subcontinent_exists) {
                continent.subcontinents.push(subcontinent);
            }
        }
    });
    if (!continent_exists) {
        continents.push(continent);
    }
});
fs.writeFile("./world.json", JSON.stringify(continents), { encoding: "utf-8" }, function (err) {
    if (err) {
        console.log(err);
    }
    else {
    }
});

//# sourceMappingURL=data:application/json;base64,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UyxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxFQUFFLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxFQUFFLFVBQVUsR0FBRztJQUN6RixFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ04sT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUNwQixDQUFDO0lBQUMsSUFBSSxDQUFDLENBQUM7SUFDUixDQUFDO0FBRUwsQ0FBQyxDQUFDLENBQUEiLCJmaWxlIjoiY3JlYXRlV29ybGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcblxuXG5cblxuaW1wb3J0ICogYXMgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgKiBhcyBhc3luYyBmcm9tIFwiYXN5bmNcIjtcbmltcG9ydCAqIGFzIF8gZnJvbSBcImxvZGFzaFwiO1xuXG5sZXQgQ29tdW5pOiBJQ29tdW5lW10gPSByZXF1aXJlKFwiLi9jb211bmkuanNvblwiKTtcblxubGV0IFJlZ2lvbmk6IElHZW9jb2Rlc1tdID0gcmVxdWlyZShcIi4vcmVnaW9uaS5qc29uXCIpO1xuXG5sZXQgY291bnRyaWVzID0gcmVxdWlyZShcImNvdW50cnlqc1wiKTtcblxubGV0IENvdW50cmllczogSUNvdW50cnlqc1tdID0gY291bnRyaWVzLmFsbCgpO1xuXG5cblxuXG5pbnRlcmZhY2UgSUdlb2NvZGVzIHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgcHJvdmluY2VzOiBJR2VvW107XG4gICAgY2l0aWVzOiBJQ2l0eVtdXG59XG5cblxuXG5pbnRlcmZhY2UgSUNpdHkge1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgIHppcGNvZGU6IG51bWJlcjtcbiAgICBjaXR5Q29kZTogc3RyaW5nO1xuICAgIHN0YXRlOiBzdHJpbmc7XG4gICAgY291bnRyeTogc3RyaW5nO1xuICAgIGlzb0xhbmc6IHN0cmluZztcbiAgICB0ejogc3RyaW5nO1xuICAgIGN1cnJlbmN5OiBzdHJpbmc7XG4gICAgY3VycmVuY3lTeW1ib2w6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIElHZW8ge1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICB6aXBjb2RlOiBzdHJpbmc7XG4gICAgY2l0aWVzOiBJQ2l0eVtdO1xuICAgIG1haW46IElDaXR5O1xuICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgbG9uZ2l0dWRlOiBudW1iZXI7XG5cbn1cblxuaW50ZXJmYWNlIElDb211bmUge1xuICAgIG5vbWU6IHN0cmluZztcbiAgICBjb2RpY2U6IG51bWJlcjtcbiAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgIHpvbmE6IHtcbiAgICAgICAgbm9tZTogc3RyaW5nO1xuICAgICAgICBjb2RpY2U6IG51bWJlcjtcbiAgICB9LFxuICAgIHJlZ2lvbmU6IHtcbiAgICAgICAgY29kaWNlOiBudW1iZXI7XG4gICAgICAgIG5vbWU6IHN0cmluZztcbiAgICB9LFxuICAgIGNtOiB7XG4gICAgICAgIGNvZGljZTogc3RyaW5nO1xuICAgICAgICBub21lOiBzdHJpbmc7XG4gICAgfSxcbiAgICBwcm92aW5jaWE6IHtcbiAgICAgICAgY29kaWNlOiBudW1iZXI7XG4gICAgICAgIG5vbWU6IHN0cmluZztcbiAgICB9LFxuICAgIHNpZ2xhOiBzdHJpbmc7XG4gICAgY29kaWNlQ2F0YXN0YWxlOiBzdHJpbmc7XG4gICAgY2FwOiBudW1iZXI7XG4gICAgc3RhdGU6IHN0cmluZztcbiAgICBjb3VudHJ5OiBzdHJpbmc7XG4gICAgemlwY29kZTogc3RyaW5nO1xuXG59XG5cbmludGVyZmFjZSBJQm91bmRhcnkge1xuXG4gICAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgICBsb25naXR1ZGU6IG51bWJlcjtcblxufVxuXG5pbnRlcmZhY2UgSWdlb0pTT05mZWF0dXJlcyB7XG4gICAgXCJ0eXBlXCI6IHN0cmluZztcbiAgICBcImlkXCI6IHN0cmluZztcbiAgICBcInByb3BlcnRpZXNcIjoge1xuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgfSxcbiAgICBcImdlb21ldHJ5XCI6IHtcbiAgICAgICAgdHlwZTogc3RyaW5nO1xuICAgICAgICBjb29yZGluYXRlczogW1xuICAgICAgICAgICAgbnVtYmVyW11bXVxuICAgICAgICBdXG4gICAgfVxufVxuXG5pbnRlcmZhY2UgSUNvdW50cnlqcyB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGFsdFNwZWxsaW5nczogc3RyaW5nW107XG4gICAgYXJlYTogbnVtYmVyO1xuICAgIFwiYm9yZGVyc1wiOiBzdHJpbmdbXTtcbiAgICBjYWxsaW5nQ29kZXM6IHN0cmluZ1tdO1xuICAgIGNhcGl0YWw6IHN0cmluZztcbiAgICBjdXJyZW5jaWVzOiBzdHJpbmdbXTtcbiAgICBkZW1vbnltOiBzdHJpbmc7XG4gICAgZmxhZzogc3RyaW5nO1xuICAgIGdlb0pTT046IHtcbiAgICAgICAgdHlwZTogc3RyaW5nO1xuICAgICAgICBmZWF0dXJlczogSWdlb0pTT05mZWF0dXJlc1tdO1xuICAgIH07XG4gICAgSVNPOiB7XG4gICAgICAgIDI6IHN0cmluZztcbiAgICAgICAgMzogc3RyaW5nO1xuICAgICAgICBhbHBoYTI6IHN0cmluZztcbiAgICAgICAgYWxwaGEzOiBzdHJpbmc7XG4gICAgfTtcbiAgICBsYW5ndWFnZXM6IHN0cmluZ1tdO1xuICAgIGxhdGxuZzogbnVtYmVyW107XG4gICAgbmF0aXZlTmFtZTogc3RyaW5nO1xuICAgIHBvcHVsYXRpb246IG51bWJlcjtcbiAgICBwcm92aW5jZXM6IHN0cmluZ1tdO1xuICAgIHJlZ2lvbjogc3RyaW5nO1xuICAgIHN1YnJlZ2lvbjogc3RyaW5nO1xuICAgIHRpbWV6b25lczogc3RyaW5nW107XG4gICAgXCJ0bGRcIjogc3RyaW5nW107XG4gICAgXCJ0cmFuc2xhdGlvbnNcIjoge1xuICAgICAgICBkZTogc3RyaW5nO1xuICAgICAgICBlczogc3RyaW5nO1xuICAgICAgICBmcjogc3RyaW5nO1xuICAgICAgICBqYTogc3RyaW5nO1xuICAgICAgICBpdDogc3RyaW5nO1xuICAgIH07XG4gICAgd2lraTogc3RyaW5nO1xufVxuXG5cbmNvbnN0IGFsbCA9IENvdW50cmllcztcbmNvbnN0IHRlc3RzID0gW2FsbFswXSwgYWxsWzFdXTtcblxuY29uc3QgdXNlID0gdGVzdHM7XG5cbmludGVyZmFjZSBJc3RhdGUge1xuICAgIHJlZ2lvbnM6IElHZW9jb2Rlc1tdO1xuICAgIGJvdW5kYXJpZXM6IElCb3VuZGFyeVtdO1xuICAgIGNhcGl0YWw6IElDaXR5O1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICBsYXRsbmc6IG51bWJlcltdO1xuICAgIGlzb0xhbmc6IHN0cmluZ1tdO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB0ejogc3RyaW5nO1xuXG59XG5cbmludGVyZmFjZSBJQ291bnRyeSB7XG4gICAgc3RhdGVzOiBJc3RhdGVbXTtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgYm91bmRhcmllczogSUJvdW5kYXJ5W107XG4gICAgbmF0aXZlTmFtZTogc3RyaW5nO1xuICAgIGNhcGl0YWw6IElDaXR5O1xuICAgIGN1cnJlbmNpZXM6IHN0cmluZ1tdO1xuICAgIGlzb0xhbmc6IHN0cmluZ1tdO1xuICAgIGxhdGxuZzogbnVtYmVyW107XG4gICAgdHo6IHN0cmluZztcblxufVxuXG5pbnRlcmZhY2UgSVN1YmNvbnRpbmVudCB7XG5cbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgY291bnRyaWVzOiBJQ291bnRyeVtdO1xuICAgIGJvdW5kYXJpZXM6IElCb3VuZGFyeVtdO1xufVxuXG5pbnRlcmZhY2UgSUdlb2J1aWxkIHtcblxuICAgIG5hbWU6IHN0cmluZztcbiAgICBzdWJjb250aW5lbnRzOiBJU3ViY29udGluZW50W107XG4gICAgYm91bmRhcmllczogSUJvdW5kYXJ5W107XG5cbn1cblxuXG5cbmNvbnN0IEdlb2J1aWxkczogSUdlb2J1aWxkW10gPSBbXTtcblxuXG5cbmNvbnN0IGNvbnRpbmVudHM6IElHZW9idWlsZFtdID0gW11cblxuXy5tYXAodXNlLCBmdW5jdGlvbiAoY291bnRyeWpzKSB7XG4gICAgbGV0IGNvbnRpbmVudF9leGlzdHMgPSBmYWxzZTtcblxuXG4gICAgbGV0IGNhcGl0YWw6IElDaXR5O1xuICAgIGxldCBjb3VudHJ5OiBJQ291bnRyeSA9IHsgdHo6IFwiXCIsIGNhcGl0YWw6IGNhcGl0YWwsIGxhdGxuZzogY291bnRyeWpzLmxhdGxuZywgbmF0aXZlTmFtZTogY291bnRyeWpzLm5hdGl2ZU5hbWUsIG5hbWU6IGNvdW50cnlqcy5uYW1lLCBzdGF0ZXM6IFtdLCBib3VuZGFyaWVzOiBbXSwgY3VycmVuY2llczogY291bnRyeWpzLmN1cnJlbmNpZXMsIGlzb0xhbmc6IGNvdW50cnlqcy5sYW5ndWFnZXMgfVxuICAgIGlmIChjb3VudHJ5Lm5hbWUgPT09IFwiQWZnaGFuaXN0YW5cIikge1xuICAgICAgICBfLm1hcChSZWdpb25pLCBmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgXy5tYXAocC5jaXRpZXMsIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHQubmF0aXZlTmFtZSA9PT0gXCJSb21hXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSb21hXCIpXG5cbiAgICAgICAgICAgICAgICAgICAgY291bnRyeS5zdGF0ZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBjb3VudHJ5Lm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVOYW1lOiBjb3VudHJ5Lm5hdGl2ZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXRsbmc6IGNvdW50cnkubGF0bG5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVnaW9uczogUmVnaW9uaSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdW5kYXJpZXM6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FwaXRhbDogdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzb0xhbmc6IGNvdW50cnkuaXNvTGFuZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR6OiBjb3VudHJ5LnR6XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG4gICAgbGV0IHN1YmNvbnRpbmVudDogSVN1YmNvbnRpbmVudCA9IHsgbmFtZTogY291bnRyeWpzLnN1YnJlZ2lvbiwgY291bnRyaWVzOiBbY291bnRyeV0sIGJvdW5kYXJpZXM6IFtdIH1cblxuICAgIGxldCBjb250aW5lbnQ6IElHZW9idWlsZCA9IHsgbmFtZTogY291bnRyeWpzLnJlZ2lvbiwgc3ViY29udGluZW50czogW3N1YmNvbnRpbmVudF0sIGJvdW5kYXJpZXM6IFtdIH1cblxuXG4gICAgXy5tYXAoY29udGluZW50cywgZnVuY3Rpb24gKGNvbnQpIHtcblxuICAgICAgICBsZXQgc3ViY29udGluZW50X2V4aXN0cyA9IGZhbHNlO1xuXG5cbiAgICAgICAgaWYgKGNvbnQubmFtZSA9PT0gY29udGluZW50Lm5hbWUpIHtcbiAgICAgICAgICAgIGNvbnRpbmVudF9leGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgXy5tYXAoY29udC5zdWJjb250aW5lbnRzLCBmdW5jdGlvbiAoc3ViKSB7XG5cblxuICAgICAgICAgICAgICAgIGlmIChzdWIubmFtZSA9PT0gc3ViY29udGluZW50Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViY29udGluZW50X2V4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb3VudHJ5X2V4aXN0cyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBfLm1hcChzdWIuY291bnRyaWVzLCBmdW5jdGlvbiAoY28pIHtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY28ubmFtZSA9PT0gY291bnRyeS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeV9leGlzdHMgPSB0cnVlO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvdW50cnlfZXhpc3RzKSB7XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJjb250aW5lbnQuY291bnRyaWVzLnB1c2goY291bnRyeSlcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKCFzdWJjb250aW5lbnRfZXhpc3RzKSB7XG5cbiAgICAgICAgICAgICAgICBjb250aW5lbnQuc3ViY29udGluZW50cy5wdXNoKHN1YmNvbnRpbmVudClcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cblxuICAgIH0pXG5cblxuICAgIGlmICghY29udGluZW50X2V4aXN0cykge1xuXG4gICAgICAgIGNvbnRpbmVudHMucHVzaChjb250aW5lbnQpXG4gICAgfVxuXG5cbn0pXG5cblxuZnMud3JpdGVGaWxlKFwiLi93b3JsZC5qc29uXCIsIEpTT04uc3RyaW5naWZ5KGNvbnRpbmVudHMpLCB7IGVuY29kaW5nOiBcInV0Zi04XCIgfSwgZnVuY3Rpb24gKGVycikge1xuICAgIGlmIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgIH0gZWxzZSB7XG4gICAgfVxuXG59KSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==

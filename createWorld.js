"use strict";
var fs = require("fs");
var _ = require("lodash");
var Comuni = require("./comuni.json");
var Regioni = require("./regioni.json");
var countries = require("countryjs");
var Countries = countries.all();
var all = Countries;
var tests = [all[0], all[1]];
var use = all;
var Geobuilds = [];
var continents = [];
var continent_exists = false;
var subcontinent_exists = false;
var country_exists = false;
_.map(use, function (countryjs) {
    continent_exists = false;
    var Capital;
    var Country = { tz: "", capital: Capital, latlng: countryjs.latlng, nativeName: countryjs.nativeName, name: countryjs.name, states: [], boundaries: [], currencies: countryjs.currencies, isoLang: countryjs.languages };
    if (Country.name === "Italy") {
        _.map(Regioni, function (p) {
            _.map(p.cities, function (t) {
                if (t.nativeName === "Roma") {
                    console.log("Roma");
                    Country.tz = "Europe/Rome";
                    Country.states.push({
                        name: "Italy",
                        nativeName: "Italia",
                        latlng: Country.latlng,
                        regions: Regioni,
                        boundaries: [],
                        capital: t,
                        isoLang: Country.isoLang,
                        tz: Country.tz
                    });
                }
            });
        });
    }
    var Subcontinent = { name: countryjs.subregion, countries: [Country], boundaries: [] };
    var Continent = { name: countryjs.region, subcontinents: [Subcontinent], boundaries: [] };
    _.map(continents, function (continent) {
        subcontinent_exists = false;
        if (continent.name === Continent.name) {
            continent_exists = true;
            _.map(continent.subcontinents, function (subcontinent) {
                if (subcontinent.name === Subcontinent.name) {
                    subcontinent_exists = true;
                    country_exists = false;
                    _.map(subcontinent.countries, function (country) {
                        if (country.name === Country.name) {
                            country_exists = true;
                        }
                    });
                    if (!country_exists) {
                        console.log("country");
                        subcontinent.countries.push(Country);
                    }
                }
            });
            if (!subcontinent_exists) {
                console.log("subcontinent_exists");
                continent.subcontinents.push(Subcontinent);
            }
        }
    });
    if (!continent_exists) {
        continents.push(Continent);
        console.log("subcontinent_exists");
    }
});
fs.writeFile("./world.json", JSON.stringify(continents), { encoding: "utf-8" }, function (err) {
    if (err) {
        console.log(err);
    }
    else {
    }
});

//# sourceMappingURL=data:application/json;base64,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QUE7WUFDOUMsQ0FBQztRQUVMLENBQUM7SUFHTCxDQUFDLENBQUMsQ0FBQTtJQUdGLEVBQUUsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDO1FBRXBCLFVBQVUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUE7UUFDMUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFBO0lBRXRDLENBQUM7QUFHTCxDQUFDLENBQUMsQ0FBQTtBQUdGLEVBQUUsQ0FBQyxTQUFTLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLEVBQUUsRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLEVBQUUsVUFBVSxHQUFHO0lBQ3pGLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDTixPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0lBQ3BCLENBQUM7SUFBQyxJQUFJLENBQUMsQ0FBQztJQUNSLENBQUM7QUFFTCxDQUFDLENBQUMsQ0FBQSIsImZpbGUiOiJjcmVhdGVXb3JsZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuXG5cblxuXG5pbXBvcnQgKiBhcyBmcyBmcm9tIFwiZnNcIjtcbmltcG9ydCAqIGFzIGFzeW5jIGZyb20gXCJhc3luY1wiO1xuaW1wb3J0ICogYXMgXyBmcm9tIFwibG9kYXNoXCI7XG5cbmxldCBDb211bmk6IElDb211bmVbXSA9IHJlcXVpcmUoXCIuL2NvbXVuaS5qc29uXCIpO1xuXG5sZXQgUmVnaW9uaTogSUdlb2NvZGVzW10gPSByZXF1aXJlKFwiLi9yZWdpb25pLmpzb25cIik7XG5cbmxldCBjb3VudHJpZXMgPSByZXF1aXJlKFwiY291bnRyeWpzXCIpO1xuXG5sZXQgQ291bnRyaWVzOiBJQ291bnRyeWpzW10gPSBjb3VudHJpZXMuYWxsKCk7XG5cblxuXG5cbmludGVyZmFjZSBJR2VvY29kZXMge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBwcm92aW5jZXM6IElHZW9bXTtcbiAgICBjaXRpZXM6IElDaXR5W11cbn1cblxuXG5cbmludGVyZmFjZSBJQ2l0eSB7XG4gICAgbmF0aXZlTmFtZTogc3RyaW5nO1xuICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgbG9uZ2l0dWRlOiBudW1iZXI7XG4gICAgemlwY29kZTogbnVtYmVyO1xuICAgIGNpdHlDb2RlOiBzdHJpbmc7XG4gICAgc3RhdGU6IHN0cmluZztcbiAgICBjb3VudHJ5OiBzdHJpbmc7XG4gICAgaXNvTGFuZzogc3RyaW5nO1xuICAgIHR6OiBzdHJpbmc7XG4gICAgY3VycmVuY3k6IHN0cmluZztcbiAgICBjdXJyZW5jeVN5bWJvbDogc3RyaW5nO1xuICAgIHJlZ2lvbjogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgSUdlbyB7XG4gICAgbmF0aXZlTmFtZTogc3RyaW5nO1xuICAgIHppcGNvZGU6IHN0cmluZztcbiAgICBjaXRpZXM6IElDaXR5W107XG4gICAgbWFpbjogSUNpdHk7XG4gICAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgICBsb25naXR1ZGU6IG51bWJlcjtcblxufVxuXG5pbnRlcmZhY2UgSUNvbXVuZSB7XG4gICAgbm9tZTogc3RyaW5nO1xuICAgIGNvZGljZTogbnVtYmVyO1xuICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgbG9uZ2l0dWRlOiBudW1iZXI7XG4gICAgem9uYToge1xuICAgICAgICBub21lOiBzdHJpbmc7XG4gICAgICAgIGNvZGljZTogbnVtYmVyO1xuICAgIH0sXG4gICAgcmVnaW9uZToge1xuICAgICAgICBjb2RpY2U6IG51bWJlcjtcbiAgICAgICAgbm9tZTogc3RyaW5nO1xuICAgIH0sXG4gICAgY206IHtcbiAgICAgICAgY29kaWNlOiBzdHJpbmc7XG4gICAgICAgIG5vbWU6IHN0cmluZztcbiAgICB9LFxuICAgIHByb3ZpbmNpYToge1xuICAgICAgICBjb2RpY2U6IG51bWJlcjtcbiAgICAgICAgbm9tZTogc3RyaW5nO1xuICAgIH0sXG4gICAgc2lnbGE6IHN0cmluZztcbiAgICBjb2RpY2VDYXRhc3RhbGU6IHN0cmluZztcbiAgICBjYXA6IG51bWJlcjtcbiAgICBzdGF0ZTogc3RyaW5nO1xuICAgIGNvdW50cnk6IHN0cmluZztcbiAgICB6aXBjb2RlOiBzdHJpbmc7XG5cbn1cblxuaW50ZXJmYWNlIElCb3VuZGFyeSB7XG5cbiAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuXG59XG5cbmludGVyZmFjZSBJZ2VvSlNPTmZlYXR1cmVzIHtcbiAgICBcInR5cGVcIjogc3RyaW5nO1xuICAgIFwiaWRcIjogc3RyaW5nO1xuICAgIFwicHJvcGVydGllc1wiOiB7XG4gICAgICAgIG5hbWU6IHN0cmluZztcbiAgICB9LFxuICAgIFwiZ2VvbWV0cnlcIjoge1xuICAgICAgICB0eXBlOiBzdHJpbmc7XG4gICAgICAgIGNvb3JkaW5hdGVzOiBbXG4gICAgICAgICAgICBudW1iZXJbXVtdXG4gICAgICAgIF1cbiAgICB9XG59XG5cbmludGVyZmFjZSBJQ291bnRyeWpzIHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgYWx0U3BlbGxpbmdzOiBzdHJpbmdbXTtcbiAgICBhcmVhOiBudW1iZXI7XG4gICAgXCJib3JkZXJzXCI6IHN0cmluZ1tdO1xuICAgIGNhbGxpbmdDb2Rlczogc3RyaW5nW107XG4gICAgY2FwaXRhbDogc3RyaW5nO1xuICAgIGN1cnJlbmNpZXM6IHN0cmluZ1tdO1xuICAgIGRlbW9ueW06IHN0cmluZztcbiAgICBmbGFnOiBzdHJpbmc7XG4gICAgZ2VvSlNPTjoge1xuICAgICAgICB0eXBlOiBzdHJpbmc7XG4gICAgICAgIGZlYXR1cmVzOiBJZ2VvSlNPTmZlYXR1cmVzW107XG4gICAgfTtcbiAgICBJU086IHtcbiAgICAgICAgMjogc3RyaW5nO1xuICAgICAgICAzOiBzdHJpbmc7XG4gICAgICAgIGFscGhhMjogc3RyaW5nO1xuICAgICAgICBhbHBoYTM6IHN0cmluZztcbiAgICB9O1xuICAgIGxhbmd1YWdlczogc3RyaW5nW107XG4gICAgbGF0bG5nOiBudW1iZXJbXTtcbiAgICBuYXRpdmVOYW1lOiBzdHJpbmc7XG4gICAgcG9wdWxhdGlvbjogbnVtYmVyO1xuICAgIHByb3ZpbmNlczogc3RyaW5nW107XG4gICAgcmVnaW9uOiBzdHJpbmc7XG4gICAgc3VicmVnaW9uOiBzdHJpbmc7XG4gICAgdGltZXpvbmVzOiBzdHJpbmdbXTtcbiAgICBcInRsZFwiOiBzdHJpbmdbXTtcbiAgICBcInRyYW5zbGF0aW9uc1wiOiB7XG4gICAgICAgIGRlOiBzdHJpbmc7XG4gICAgICAgIGVzOiBzdHJpbmc7XG4gICAgICAgIGZyOiBzdHJpbmc7XG4gICAgICAgIGphOiBzdHJpbmc7XG4gICAgICAgIGl0OiBzdHJpbmc7XG4gICAgfTtcbiAgICB3aWtpOiBzdHJpbmc7XG59XG5cblxuY29uc3QgYWxsID0gQ291bnRyaWVzO1xuY29uc3QgdGVzdHMgPSBbYWxsWzBdLCBhbGxbMV1dO1xuXG5jb25zdCB1c2UgPSBhbGw7XG5cbmludGVyZmFjZSBJc3RhdGUge1xuICAgIHJlZ2lvbnM6IElHZW9jb2Rlc1tdO1xuICAgIGJvdW5kYXJpZXM6IElCb3VuZGFyeVtdO1xuICAgIGNhcGl0YWw6IElDaXR5O1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICBsYXRsbmc6IG51bWJlcltdO1xuICAgIGlzb0xhbmc6IHN0cmluZ1tdO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB0ejogc3RyaW5nO1xuXG59XG5cbmludGVyZmFjZSBJQ291bnRyeSB7XG4gICAgc3RhdGVzOiBJc3RhdGVbXTtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgYm91bmRhcmllczogSUJvdW5kYXJ5W107XG4gICAgbmF0aXZlTmFtZTogc3RyaW5nO1xuICAgIGNhcGl0YWw6IElDaXR5O1xuICAgIGN1cnJlbmNpZXM6IHN0cmluZ1tdO1xuICAgIGlzb0xhbmc6IHN0cmluZ1tdO1xuICAgIGxhdGxuZzogbnVtYmVyW107XG4gICAgdHo6IHN0cmluZztcblxufVxuXG5pbnRlcmZhY2UgSVN1YmNvbnRpbmVudCB7XG5cbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgY291bnRyaWVzOiBJQ291bnRyeVtdO1xuICAgIGJvdW5kYXJpZXM6IElCb3VuZGFyeVtdO1xufVxuXG5pbnRlcmZhY2UgSUdlb2J1aWxkIHtcblxuICAgIG5hbWU6IHN0cmluZztcbiAgICBzdWJjb250aW5lbnRzOiBJU3ViY29udGluZW50W107XG4gICAgYm91bmRhcmllczogSUJvdW5kYXJ5W107XG5cbn1cblxuXG5cbmNvbnN0IEdlb2J1aWxkczogSUdlb2J1aWxkW10gPSBbXTtcblxuXG5cbmNvbnN0IGNvbnRpbmVudHM6IElHZW9idWlsZFtdID0gW11cblxuXG5sZXQgY29udGluZW50X2V4aXN0cyA9IGZhbHNlO1xubGV0IHN1YmNvbnRpbmVudF9leGlzdHMgPSBmYWxzZTtcbmxldCBjb3VudHJ5X2V4aXN0cyA9IGZhbHNlO1xuXG5cbl8ubWFwKHVzZSwgZnVuY3Rpb24gKGNvdW50cnlqcykge1xuXG5cbiAgICBjb250aW5lbnRfZXhpc3RzID0gZmFsc2U7XG5cblxuICAgIGxldCBDYXBpdGFsOiBJQ2l0eTtcbiAgICBsZXQgQ291bnRyeTogSUNvdW50cnkgPSB7IHR6OiBcIlwiLCBjYXBpdGFsOiBDYXBpdGFsLCBsYXRsbmc6IGNvdW50cnlqcy5sYXRsbmcsIG5hdGl2ZU5hbWU6IGNvdW50cnlqcy5uYXRpdmVOYW1lLCBuYW1lOiBjb3VudHJ5anMubmFtZSwgc3RhdGVzOiBbXSwgYm91bmRhcmllczogW10sIGN1cnJlbmNpZXM6IGNvdW50cnlqcy5jdXJyZW5jaWVzLCBpc29MYW5nOiBjb3VudHJ5anMubGFuZ3VhZ2VzIH1cbiAgICBpZiAoQ291bnRyeS5uYW1lID09PSBcIkl0YWx5XCIpIHtcbiAgICAgICAgXy5tYXAoUmVnaW9uaSwgZnVuY3Rpb24gKHApIHtcbiAgICAgICAgICAgIF8ubWFwKHAuY2l0aWVzLCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgICAgIGlmICh0Lm5hdGl2ZU5hbWUgPT09IFwiUm9tYVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiUm9tYVwiKVxuICAgICAgICAgICAgICAgICAgICBDb3VudHJ5LnR6ID0gXCJFdXJvcGUvUm9tZVwiO1xuICAgICAgICAgICAgICAgICAgICBDb3VudHJ5LnN0YXRlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiSXRhbHlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZU5hbWU6IFwiSXRhbGlhXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXRsbmc6IENvdW50cnkubGF0bG5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVnaW9uczogUmVnaW9uaSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdW5kYXJpZXM6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FwaXRhbDogdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzb0xhbmc6IENvdW50cnkuaXNvTGFuZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR6OiBDb3VudHJ5LnR6XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG4gICAgbGV0IFN1YmNvbnRpbmVudDogSVN1YmNvbnRpbmVudCA9IHsgbmFtZTogY291bnRyeWpzLnN1YnJlZ2lvbiwgY291bnRyaWVzOiBbQ291bnRyeV0sIGJvdW5kYXJpZXM6IFtdIH1cblxuICAgIGxldCBDb250aW5lbnQ6IElHZW9idWlsZCA9IHsgbmFtZTogY291bnRyeWpzLnJlZ2lvbiwgc3ViY29udGluZW50czogW1N1YmNvbnRpbmVudF0sIGJvdW5kYXJpZXM6IFtdIH1cblxuXG4gICAgXy5tYXAoY29udGluZW50cywgZnVuY3Rpb24gKGNvbnRpbmVudCkge1xuXG4gICAgICAgIHN1YmNvbnRpbmVudF9leGlzdHMgPSBmYWxzZTtcblxuXG4gICAgICAgIGlmIChjb250aW5lbnQubmFtZSA9PT0gQ29udGluZW50Lm5hbWUpIHtcbiAgICAgICAgICAgIGNvbnRpbmVudF9leGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgXy5tYXAoY29udGluZW50LnN1YmNvbnRpbmVudHMsIGZ1bmN0aW9uIChzdWJjb250aW5lbnQpIHtcblxuXG4gICAgICAgICAgICAgICAgaWYgKHN1YmNvbnRpbmVudC5uYW1lID09PSBTdWJjb250aW5lbnQubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBzdWJjb250aW5lbnRfZXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY291bnRyeV9leGlzdHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgXy5tYXAoc3ViY29udGluZW50LmNvdW50cmllcywgZnVuY3Rpb24gKGNvdW50cnkpIHtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnRyeS5uYW1lID09PSBDb3VudHJ5Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5X2V4aXN0cyA9IHRydWU7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghY291bnRyeV9leGlzdHMpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjb3VudHJ5XCIpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YmNvbnRpbmVudC5jb3VudHJpZXMucHVzaChDb3VudHJ5KVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBpZiAoIXN1YmNvbnRpbmVudF9leGlzdHMpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInN1YmNvbnRpbmVudF9leGlzdHNcIilcblxuICAgICAgICAgICAgICAgIGNvbnRpbmVudC5zdWJjb250aW5lbnRzLnB1c2goU3ViY29udGluZW50KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuXG4gICAgfSlcblxuXG4gICAgaWYgKCFjb250aW5lbnRfZXhpc3RzKSB7XG5cbiAgICAgICAgY29udGluZW50cy5wdXNoKENvbnRpbmVudClcbiAgICAgICAgY29uc29sZS5sb2coXCJzdWJjb250aW5lbnRfZXhpc3RzXCIpXG5cbiAgICB9XG5cblxufSlcblxuXG5mcy53cml0ZUZpbGUoXCIuL3dvcmxkLmpzb25cIiwgSlNPTi5zdHJpbmdpZnkoY29udGluZW50cyksIHsgZW5jb2Rpbmc6IFwidXRmLThcIiB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgaWYgKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgfSBlbHNlIHtcbiAgICB9XG5cbn0pIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9

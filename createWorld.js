"use strict";
var fs = require("fs");
var _ = require("lodash");
var Comuni = require("./comuni.json");
var Regioni = require("./regioni.json");
var countries = require("countryjs");
var Countries = countries.all();
var all = Countries;
var tests = [all[0], all[1]];
var use = all;
var Geobuilds = [];
var continents = [];
var continent_exists = false;
var subcontinent_exists = false;
var country_exists = false;
_.map(use, function (countryjs) {
    continent_exists = false;
    var bcords = [];
    if (countryjs.geoJSON && countryjs.geoJSON.features && countryjs.geoJSON.features[0] && countryjs.geoJSON.features[0].geometry && countryjs.geoJSON.features[0].geometry.coordinates) {
        bcords = countryjs.geoJSON.features[0].geometry.coordinates;
    }
    var Capital;
    var Country = { tz: "", subcontinent: "", continent: "", capital: Capital, latlng: countryjs.latlng, nativeName: countryjs.nativeName, name: countryjs.name, states: [], boundaries: bcords, currencies: countryjs.currencies, isoLang: countryjs.languages };
    if (Country.name === "Italy") {
        _.map(Regioni, function (p) {
            _.map(p.cities, function (t) {
                if (t.nativeName === "Roma") {
                    console.log("Roma");
                    Country.tz = "Europe/Rome";
                    Country.states.push({
                        country: "Italy",
                        continent: countryjs.region,
                        subcontinent: countryjs.subregion,
                        name: "Italy",
                        nativeName: "Italia",
                        latlng: Country.latlng,
                        regions: Regioni,
                        boundaries: Country.boundaries,
                        capital: t,
                        isoLang: Country.isoLang,
                        tz: Country.tz
                    });
                }
            });
        });
    }
    var Subcontinent = { name: countryjs.subregion, countries: [Country], boundaries: [] };
    var Continent = { name: countryjs.region, subcontinents: [Subcontinent], boundaries: [] };
    _.map(continents, function (continent) {
        subcontinent_exists = false;
        if (continent.name === Continent.name) {
            continent_exists = true;
            _.map(continent.subcontinents, function (subcontinent) {
                if (subcontinent.name === Subcontinent.name) {
                    subcontinent_exists = true;
                    country_exists = false;
                    _.map(subcontinent.countries, function (country) {
                        if (country.name === Country.name) {
                            country_exists = true;
                        }
                    });
                    if (!country_exists) {
                        console.log("country");
                        subcontinent.countries.push(Country);
                    }
                }
            });
            if (!subcontinent_exists) {
                console.log("subcontinent_exists");
                continent.subcontinents.push(Subcontinent);
            }
        }
    });
    if (!continent_exists) {
        continents.push(Continent);
        console.log("subcontinent_exists");
    }
});
fs.writeFile("./world.json", JSON.stringify(continents), { encoding: "utf-8" }, function (err) {
    if (err) {
        console.log(err);
    }
    else {
    }
});

//# sourceMappingURL=data:application/json;base64,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QTtJQUNwQixDQUFDO0lBQUMsSUFBSSxDQUFDLENBQUM7SUFDUixDQUFDO0FBRUwsQ0FBQyxDQUFDLENBQUEiLCJmaWxlIjoiY3JlYXRlV29ybGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcblxuXG5cblxuaW1wb3J0ICogYXMgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgKiBhcyBhc3luYyBmcm9tIFwiYXN5bmNcIjtcbmltcG9ydCAqIGFzIF8gZnJvbSBcImxvZGFzaFwiO1xuXG5sZXQgQ29tdW5pOiBJQ29tdW5lW10gPSByZXF1aXJlKFwiLi9jb211bmkuanNvblwiKTtcblxubGV0IFJlZ2lvbmk6IElHZW9jb2Rlc1tdID0gcmVxdWlyZShcIi4vcmVnaW9uaS5qc29uXCIpO1xuXG5sZXQgY291bnRyaWVzID0gcmVxdWlyZShcImNvdW50cnlqc1wiKTtcblxubGV0IENvdW50cmllczogSUNvdW50cnlqc1tdID0gY291bnRyaWVzLmFsbCgpO1xuXG5cblxuXG5pbnRlcmZhY2UgSUdlb2NvZGVzIHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgcHJvdmluY2VzOiBJR2VvW107XG4gICAgY2l0aWVzOiBJQ2l0eVtdXG59XG5cblxuXG5pbnRlcmZhY2UgSUNpdHkge1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgIHppcGNvZGU6IG51bWJlcjtcbiAgICBjaXR5Q29kZTogc3RyaW5nO1xuICAgIHN0YXRlOiBzdHJpbmc7XG4gICAgY291bnRyeTogc3RyaW5nO1xuICAgIGlzb0xhbmc6IHN0cmluZztcbiAgICB0ejogc3RyaW5nO1xuICAgIGN1cnJlbmN5OiBzdHJpbmc7XG4gICAgY3VycmVuY3lTeW1ib2w6IHN0cmluZztcbiAgICBkaXN0YW5jZT86IG51bWJlcjtcbiAgICBzdWJjb250aW5lbnQ6IHN0cmluZztcbiAgICBjb250aW5lbnQ6IHN0cmluZztcbiAgICByZWdpb246IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIElHZW8ge1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICB6aXBjb2RlOiBzdHJpbmc7XG4gICAgY2l0aWVzOiBJQ2l0eVtdO1xuICAgIG1haW46IElDaXR5O1xuICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgbG9uZ2l0dWRlOiBudW1iZXI7XG5cbn1cblxuaW50ZXJmYWNlIElDb211bmUge1xuICAgIG5vbWU6IHN0cmluZztcbiAgICBjb2RpY2U6IG51bWJlcjtcbiAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgIHpvbmE6IHtcbiAgICAgICAgbm9tZTogc3RyaW5nO1xuICAgICAgICBjb2RpY2U6IG51bWJlcjtcbiAgICB9LFxuICAgIHJlZ2lvbmU6IHtcbiAgICAgICAgY29kaWNlOiBudW1iZXI7XG4gICAgICAgIG5vbWU6IHN0cmluZztcbiAgICB9LFxuICAgIGNtOiB7XG4gICAgICAgIGNvZGljZTogc3RyaW5nO1xuICAgICAgICBub21lOiBzdHJpbmc7XG4gICAgfSxcbiAgICBwcm92aW5jaWE6IHtcbiAgICAgICAgY29kaWNlOiBudW1iZXI7XG4gICAgICAgIG5vbWU6IHN0cmluZztcbiAgICB9LFxuICAgIHNpZ2xhOiBzdHJpbmc7XG4gICAgY29kaWNlQ2F0YXN0YWxlOiBzdHJpbmc7XG4gICAgY2FwOiBudW1iZXI7XG4gICAgc3RhdGU6IHN0cmluZztcbiAgICBjb3VudHJ5OiBzdHJpbmc7XG4gICAgemlwY29kZTogc3RyaW5nO1xuXG59XG5cbmludGVyZmFjZSBJQm91bmRhcnkge1xuXG4gICAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgICBsb25naXR1ZGU6IG51bWJlcjtcblxufVxuXG5pbnRlcmZhY2UgSWdlb0pTT05mZWF0dXJlcyB7XG4gICAgXCJ0eXBlXCI6IHN0cmluZztcbiAgICBcImlkXCI6IHN0cmluZztcbiAgICBcInByb3BlcnRpZXNcIjoge1xuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgfSxcbiAgICBcImdlb21ldHJ5XCI6IHtcbiAgICAgICAgdHlwZTogc3RyaW5nO1xuICAgICAgICBjb29yZGluYXRlczogW1xuICAgICAgICAgICAgSUJvdW5kYXJ5W11cbiAgICAgICAgXVxuICAgIH1cbn1cblxuaW50ZXJmYWNlIElDb3VudHJ5anMge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBhbHRTcGVsbGluZ3M6IHN0cmluZ1tdO1xuICAgIGFyZWE6IG51bWJlcjtcbiAgICBcImJvcmRlcnNcIjogc3RyaW5nW107XG4gICAgY2FsbGluZ0NvZGVzOiBzdHJpbmdbXTtcbiAgICBjYXBpdGFsOiBzdHJpbmc7XG4gICAgY3VycmVuY2llczogc3RyaW5nW107XG4gICAgZGVtb255bTogc3RyaW5nO1xuICAgIGZsYWc6IHN0cmluZztcbiAgICBnZW9KU09OOiB7XG4gICAgICAgIHR5cGU6IHN0cmluZztcbiAgICAgICAgZmVhdHVyZXM6IElnZW9KU09OZmVhdHVyZXNbXTtcbiAgICB9O1xuICAgIElTTzoge1xuICAgICAgICAyOiBzdHJpbmc7XG4gICAgICAgIDM6IHN0cmluZztcbiAgICAgICAgYWxwaGEyOiBzdHJpbmc7XG4gICAgICAgIGFscGhhMzogc3RyaW5nO1xuICAgIH07XG4gICAgbGFuZ3VhZ2VzOiBzdHJpbmdbXTtcbiAgICBsYXRsbmc6IG51bWJlcltdO1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICBwb3B1bGF0aW9uOiBudW1iZXI7XG4gICAgcHJvdmluY2VzOiBzdHJpbmdbXTtcbiAgICByZWdpb246IHN0cmluZztcbiAgICBzdWJyZWdpb246IHN0cmluZztcbiAgICB0aW1lem9uZXM6IHN0cmluZ1tdO1xuICAgIFwidGxkXCI6IHN0cmluZ1tdO1xuICAgIFwidHJhbnNsYXRpb25zXCI6IHtcbiAgICAgICAgZGU6IHN0cmluZztcbiAgICAgICAgZXM6IHN0cmluZztcbiAgICAgICAgZnI6IHN0cmluZztcbiAgICAgICAgamE6IHN0cmluZztcbiAgICAgICAgaXQ6IHN0cmluZztcbiAgICB9O1xuICAgIHdpa2k6IHN0cmluZztcbn1cblxuXG5jb25zdCBhbGwgPSBDb3VudHJpZXM7XG5jb25zdCB0ZXN0cyA9IFthbGxbMF0sIGFsbFsxXV07XG5cbmNvbnN0IHVzZSA9IGFsbDtcblxuXG5pbnRlcmZhY2UgSXN0YXRlIHtcbiAgICByZWdpb25zOiBJR2VvY29kZXNbXTtcbiAgICBib3VuZGFyaWVzOiBJQm91bmRhcnlbXVtdO1xuICAgIGNhcGl0YWw6IElDaXR5O1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICBsYXRsbmc6IG51bWJlcltdO1xuICAgIGlzb0xhbmc6IHN0cmluZ1tdO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB0ejogc3RyaW5nO1xuICAgIGNvdW50cnk6IHN0cmluZztcbiAgICBzdWJjb250aW5lbnQ6IHN0cmluZztcbiAgICBjb250aW5lbnQ6IHN0cmluZztcblxufVxuXG5pbnRlcmZhY2UgSUNvdW50cnkge1xuICAgIHN0YXRlczogSXN0YXRlW107XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGJvdW5kYXJpZXM6IElCb3VuZGFyeVtdW107XG4gICAgbmF0aXZlTmFtZTogc3RyaW5nO1xuICAgIGNhcGl0YWw6IElDaXR5O1xuICAgIGN1cnJlbmNpZXM6IHN0cmluZ1tdO1xuICAgIGlzb0xhbmc6IHN0cmluZ1tdO1xuICAgIGxhdGxuZzogbnVtYmVyW107XG4gICAgdHo6IHN0cmluZztcbiAgICBzdWJjb250aW5lbnQ6IHN0cmluZztcbiAgICBjb250aW5lbnQ6IHN0cmluZztcblxufVxuXG5pbnRlcmZhY2UgSVN1YmNvbnRpbmVudCB7XG5cbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgY291bnRyaWVzOiBJQ291bnRyeVtdO1xuICAgIGJvdW5kYXJpZXM6IElCb3VuZGFyeVtdO1xufVxuXG5pbnRlcmZhY2UgSUdlb2J1aWxkIHtcblxuICAgIG5hbWU6IHN0cmluZztcbiAgICBzdWJjb250aW5lbnRzOiBJU3ViY29udGluZW50W107XG4gICAgYm91bmRhcmllczogSUJvdW5kYXJ5W107XG5cbn1cblxuXG5cbmNvbnN0IEdlb2J1aWxkczogSUdlb2J1aWxkW10gPSBbXTtcblxuXG5cbmNvbnN0IGNvbnRpbmVudHM6IElHZW9idWlsZFtdID0gW11cblxuXG5sZXQgY29udGluZW50X2V4aXN0cyA9IGZhbHNlO1xubGV0IHN1YmNvbnRpbmVudF9leGlzdHMgPSBmYWxzZTtcbmxldCBjb3VudHJ5X2V4aXN0cyA9IGZhbHNlO1xuXG5cbl8ubWFwKHVzZSwgZnVuY3Rpb24gKGNvdW50cnlqcykge1xuXG5cbiAgICBjb250aW5lbnRfZXhpc3RzID0gZmFsc2U7XG5cbiAgICBsZXQgYmNvcmRzID0gW107XG5cbiAgICBpZiAoY291bnRyeWpzLmdlb0pTT04gJiYgY291bnRyeWpzLmdlb0pTT04uZmVhdHVyZXMgJiYgY291bnRyeWpzLmdlb0pTT04uZmVhdHVyZXNbMF0gJiYgY291bnRyeWpzLmdlb0pTT04uZmVhdHVyZXNbMF0uZ2VvbWV0cnkgJiYgY291bnRyeWpzLmdlb0pTT04uZmVhdHVyZXNbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXMpIHtcbiAgICAgICAgYmNvcmRzID1jb3VudHJ5anMuZ2VvSlNPTi5mZWF0dXJlc1swXS5nZW9tZXRyeS5jb29yZGluYXRlcztcbn1cblxuICAgIGxldCBDYXBpdGFsOiBJQ2l0eTtcbiAgICBsZXQgQ291bnRyeTogSUNvdW50cnkgPSB7IHR6OiBcIlwiLCBzdWJjb250aW5lbnQ6IFwiXCIsIGNvbnRpbmVudDogXCJcIiwgY2FwaXRhbDogQ2FwaXRhbCwgbGF0bG5nOiBjb3VudHJ5anMubGF0bG5nLCBuYXRpdmVOYW1lOiBjb3VudHJ5anMubmF0aXZlTmFtZSwgbmFtZTogY291bnRyeWpzLm5hbWUsIHN0YXRlczogW10sIGJvdW5kYXJpZXM6IGJjb3JkcywgY3VycmVuY2llczogY291bnRyeWpzLmN1cnJlbmNpZXMsIGlzb0xhbmc6IGNvdW50cnlqcy5sYW5ndWFnZXMgfVxuICAgIGlmIChDb3VudHJ5Lm5hbWUgPT09IFwiSXRhbHlcIikge1xuICAgICAgICBfLm1hcChSZWdpb25pLCBmdW5jdGlvbiAocCkge1xuICAgICAgICAgICAgXy5tYXAocC5jaXRpZXMsIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHQubmF0aXZlTmFtZSA9PT0gXCJSb21hXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJSb21hXCIpXG4gICAgICAgICAgICAgICAgICAgIENvdW50cnkudHogPSBcIkV1cm9wZS9Sb21lXCI7XG4gICAgICAgICAgICAgICAgICAgIENvdW50cnkuc3RhdGVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeTogXCJJdGFseVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGluZW50OiBjb3VudHJ5anMucmVnaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3ViY29udGluZW50OiBjb3VudHJ5anMuc3VicmVnaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJJdGFseVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmF0aXZlTmFtZTogXCJJdGFsaWFcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhdGxuZzogQ291bnRyeS5sYXRsbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpb25zOiBSZWdpb25pLFxuICAgICAgICAgICAgICAgICAgICAgICAgYm91bmRhcmllczogQ291bnRyeS5ib3VuZGFyaWVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2FwaXRhbDogdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzb0xhbmc6IENvdW50cnkuaXNvTGFuZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHR6OiBDb3VudHJ5LnR6XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICB9XG4gICAgbGV0IFN1YmNvbnRpbmVudDogSVN1YmNvbnRpbmVudCA9IHsgbmFtZTogY291bnRyeWpzLnN1YnJlZ2lvbiwgY291bnRyaWVzOiBbQ291bnRyeV0sIGJvdW5kYXJpZXM6IFtdIH1cblxuICAgIGxldCBDb250aW5lbnQ6IElHZW9idWlsZCA9IHsgbmFtZTogY291bnRyeWpzLnJlZ2lvbiwgc3ViY29udGluZW50czogW1N1YmNvbnRpbmVudF0sIGJvdW5kYXJpZXM6IFtdIH1cblxuXG4gICAgXy5tYXAoY29udGluZW50cywgZnVuY3Rpb24gKGNvbnRpbmVudCkge1xuXG4gICAgICAgIHN1YmNvbnRpbmVudF9leGlzdHMgPSBmYWxzZTtcblxuXG4gICAgICAgIGlmIChjb250aW5lbnQubmFtZSA9PT0gQ29udGluZW50Lm5hbWUpIHtcbiAgICAgICAgICAgIGNvbnRpbmVudF9leGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgXy5tYXAoY29udGluZW50LnN1YmNvbnRpbmVudHMsIGZ1bmN0aW9uIChzdWJjb250aW5lbnQpIHtcblxuXG4gICAgICAgICAgICAgICAgaWYgKHN1YmNvbnRpbmVudC5uYW1lID09PSBTdWJjb250aW5lbnQubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBzdWJjb250aW5lbnRfZXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY291bnRyeV9leGlzdHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgXy5tYXAoc3ViY29udGluZW50LmNvdW50cmllcywgZnVuY3Rpb24gKGNvdW50cnkpIHtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnRyeS5uYW1lID09PSBDb3VudHJ5Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5X2V4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjb3VudHJ5X2V4aXN0cykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImNvdW50cnlcIilcblxuICAgICAgICAgICAgICAgICAgICAgICAgc3ViY29udGluZW50LmNvdW50cmllcy5wdXNoKENvdW50cnkpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgaWYgKCFzdWJjb250aW5lbnRfZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzdWJjb250aW5lbnRfZXhpc3RzXCIpXG5cbiAgICAgICAgICAgICAgICBjb250aW5lbnQuc3ViY29udGluZW50cy5wdXNoKFN1YmNvbnRpbmVudClcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cblxuICAgIH0pXG5cblxuICAgIGlmICghY29udGluZW50X2V4aXN0cykge1xuXG4gICAgICAgIGNvbnRpbmVudHMucHVzaChDb250aW5lbnQpXG4gICAgICAgIGNvbnNvbGUubG9nKFwic3ViY29udGluZW50X2V4aXN0c1wiKVxuXG4gICAgfVxuXG5cbn0pXG5cblxuZnMud3JpdGVGaWxlKFwiLi93b3JsZC5qc29uXCIsIEpTT04uc3RyaW5naWZ5KGNvbnRpbmVudHMpLCB7IGVuY29kaW5nOiBcInV0Zi04XCIgfSwgZnVuY3Rpb24gKGVycikge1xuICAgIGlmIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgIH0gZWxzZSB7XG4gICAgfVxuXG59KSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==

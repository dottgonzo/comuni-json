"use strict";
var fs = require("fs");
var _ = require("lodash");
var Comuni = require("./comuni.json");
var Regioni = require("./regioni.json");
var countries = require("countryjs");
var Countries = countries.all();
var all = Countries;
var tests = [all[0], all[1]];
var use = all;
var Geobuilds = [];
var continents = [];
var continent_exists = false;
var subcontinent_exists = false;
var country_exists = false;
_.map(use, function (countryjs) {
    continent_exists = false;
    var Capital;
    var Country = { tz: "", subcontinent: "", continent: "", capital: Capital, latlng: countryjs.latlng, nativeName: countryjs.nativeName, name: countryjs.name, states: [], boundaries: [], currencies: countryjs.currencies, isoLang: countryjs.languages };
    if (Country.name === "Italy") {
        _.map(Regioni, function (p) {
            _.map(p.cities, function (t) {
                if (t.nativeName === "Roma") {
                    console.log("Roma");
                    Country.tz = "Europe/Rome";
                    Country.states.push({
                        country: "Italy",
                        continent: countryjs.region,
                        subcontinent: countryjs.subregion,
                        name: "Italy",
                        nativeName: "Italia",
                        latlng: Country.latlng,
                        regions: Regioni,
                        boundaries: [],
                        capital: t,
                        isoLang: Country.isoLang,
                        tz: Country.tz
                    });
                }
            });
        });
    }
    var Subcontinent = { name: countryjs.subregion, countries: [Country], boundaries: [] };
    var Continent = { name: countryjs.region, subcontinents: [Subcontinent], boundaries: [] };
    _.map(continents, function (continent) {
        subcontinent_exists = false;
        if (continent.name === Continent.name) {
            continent_exists = true;
            _.map(continent.subcontinents, function (subcontinent) {
                if (subcontinent.name === Subcontinent.name) {
                    subcontinent_exists = true;
                    country_exists = false;
                    _.map(subcontinent.countries, function (country) {
                        if (country.name === Country.name) {
                            country_exists = true;
                        }
                    });
                    if (!country_exists) {
                        console.log("country");
                        subcontinent.countries.push(Country);
                    }
                }
            });
            if (!subcontinent_exists) {
                console.log("subcontinent_exists");
                continent.subcontinents.push(Subcontinent);
            }
        }
    });
    if (!continent_exists) {
        continents.push(Continent);
        console.log("subcontinent_exists");
    }
});
fs.writeFile("./world.json", JSON.stringify(continents), { encoding: "utf-8" }, function (err) {
    if (err) {
        console.log(err);
    }
    else {
    }
});

//# sourceMappingURL=data:application/json;base64,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Q0FBQyxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FBQztnQkFDdkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFBO2dCQUVsQyxTQUFTLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQTtZQUM5QyxDQUFDO1FBRUwsQ0FBQztJQUdMLENBQUMsQ0FBQyxDQUFBO0lBR0YsRUFBRSxDQUFDLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUM7UUFFcEIsVUFBVSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQTtRQUMxQixPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixDQUFDLENBQUE7SUFFdEMsQ0FBQztBQUdMLENBQUMsQ0FBQyxDQUFBO0FBR0YsRUFBRSxDQUFDLFNBQVMsQ0FBQyxjQUFjLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsRUFBRSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsRUFBRSxVQUFVLEdBQUc7SUFDekYsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNOLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDcEIsQ0FBQztJQUFDLElBQUksQ0FBQyxDQUFDO0lBQ1IsQ0FBQztBQUVMLENBQUMsQ0FBQyxDQUFBIiwiZmlsZSI6ImNyZWF0ZVdvcmxkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5cblxuXG5cbmltcG9ydCAqIGFzIGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0ICogYXMgYXN5bmMgZnJvbSBcImFzeW5jXCI7XG5pbXBvcnQgKiBhcyBfIGZyb20gXCJsb2Rhc2hcIjtcblxubGV0IENvbXVuaTogSUNvbXVuZVtdID0gcmVxdWlyZShcIi4vY29tdW5pLmpzb25cIik7XG5cbmxldCBSZWdpb25pOiBJR2VvY29kZXNbXSA9IHJlcXVpcmUoXCIuL3JlZ2lvbmkuanNvblwiKTtcblxubGV0IGNvdW50cmllcyA9IHJlcXVpcmUoXCJjb3VudHJ5anNcIik7XG5cbmxldCBDb3VudHJpZXM6IElDb3VudHJ5anNbXSA9IGNvdW50cmllcy5hbGwoKTtcblxuXG5cblxuaW50ZXJmYWNlIElHZW9jb2RlcyB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHByb3ZpbmNlczogSUdlb1tdO1xuICAgIGNpdGllczogSUNpdHlbXVxufVxuXG5cblxuaW50ZXJmYWNlIElDaXR5IHtcbiAgICBuYXRpdmVOYW1lOiBzdHJpbmc7XG4gICAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgICBsb25naXR1ZGU6IG51bWJlcjtcbiAgICB6aXBjb2RlOiBudW1iZXI7XG4gICAgY2l0eUNvZGU6IHN0cmluZztcbiAgICBzdGF0ZTogc3RyaW5nO1xuICAgIGNvdW50cnk6IHN0cmluZztcbiAgICBpc29MYW5nOiBzdHJpbmc7XG4gICAgdHo6IHN0cmluZztcbiAgICBjdXJyZW5jeTogc3RyaW5nO1xuICAgIGN1cnJlbmN5U3ltYm9sOiBzdHJpbmc7XG4gICAgZGlzdGFuY2U/OiBudW1iZXI7XG4gICAgc3ViY29udGluZW50OnN0cmluZztcbiAgICBjb250aW5lbnQ6c3RyaW5nO1xuICAgIHJlZ2lvbjpzdHJpbmc7XG59XG5cbmludGVyZmFjZSBJR2VvIHtcbiAgICBuYXRpdmVOYW1lOiBzdHJpbmc7XG4gICAgemlwY29kZTogc3RyaW5nO1xuICAgIGNpdGllczogSUNpdHlbXTtcbiAgICBtYWluOiBJQ2l0eTtcbiAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuXG59XG5cbmludGVyZmFjZSBJQ29tdW5lIHtcbiAgICBub21lOiBzdHJpbmc7XG4gICAgY29kaWNlOiBudW1iZXI7XG4gICAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgICBsb25naXR1ZGU6IG51bWJlcjtcbiAgICB6b25hOiB7XG4gICAgICAgIG5vbWU6IHN0cmluZztcbiAgICAgICAgY29kaWNlOiBudW1iZXI7XG4gICAgfSxcbiAgICByZWdpb25lOiB7XG4gICAgICAgIGNvZGljZTogbnVtYmVyO1xuICAgICAgICBub21lOiBzdHJpbmc7XG4gICAgfSxcbiAgICBjbToge1xuICAgICAgICBjb2RpY2U6IHN0cmluZztcbiAgICAgICAgbm9tZTogc3RyaW5nO1xuICAgIH0sXG4gICAgcHJvdmluY2lhOiB7XG4gICAgICAgIGNvZGljZTogbnVtYmVyO1xuICAgICAgICBub21lOiBzdHJpbmc7XG4gICAgfSxcbiAgICBzaWdsYTogc3RyaW5nO1xuICAgIGNvZGljZUNhdGFzdGFsZTogc3RyaW5nO1xuICAgIGNhcDogbnVtYmVyO1xuICAgIHN0YXRlOiBzdHJpbmc7XG4gICAgY291bnRyeTogc3RyaW5nO1xuICAgIHppcGNvZGU6IHN0cmluZztcblxufVxuXG5pbnRlcmZhY2UgSUJvdW5kYXJ5IHtcblxuICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgbG9uZ2l0dWRlOiBudW1iZXI7XG5cbn1cblxuaW50ZXJmYWNlIElnZW9KU09OZmVhdHVyZXMge1xuICAgIFwidHlwZVwiOiBzdHJpbmc7XG4gICAgXCJpZFwiOiBzdHJpbmc7XG4gICAgXCJwcm9wZXJ0aWVzXCI6IHtcbiAgICAgICAgbmFtZTogc3RyaW5nO1xuICAgIH0sXG4gICAgXCJnZW9tZXRyeVwiOiB7XG4gICAgICAgIHR5cGU6IHN0cmluZztcbiAgICAgICAgY29vcmRpbmF0ZXM6IFtcbiAgICAgICAgICAgIG51bWJlcltdW11cbiAgICAgICAgXVxuICAgIH1cbn1cblxuaW50ZXJmYWNlIElDb3VudHJ5anMge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBhbHRTcGVsbGluZ3M6IHN0cmluZ1tdO1xuICAgIGFyZWE6IG51bWJlcjtcbiAgICBcImJvcmRlcnNcIjogc3RyaW5nW107XG4gICAgY2FsbGluZ0NvZGVzOiBzdHJpbmdbXTtcbiAgICBjYXBpdGFsOiBzdHJpbmc7XG4gICAgY3VycmVuY2llczogc3RyaW5nW107XG4gICAgZGVtb255bTogc3RyaW5nO1xuICAgIGZsYWc6IHN0cmluZztcbiAgICBnZW9KU09OOiB7XG4gICAgICAgIHR5cGU6IHN0cmluZztcbiAgICAgICAgZmVhdHVyZXM6IElnZW9KU09OZmVhdHVyZXNbXTtcbiAgICB9O1xuICAgIElTTzoge1xuICAgICAgICAyOiBzdHJpbmc7XG4gICAgICAgIDM6IHN0cmluZztcbiAgICAgICAgYWxwaGEyOiBzdHJpbmc7XG4gICAgICAgIGFscGhhMzogc3RyaW5nO1xuICAgIH07XG4gICAgbGFuZ3VhZ2VzOiBzdHJpbmdbXTtcbiAgICBsYXRsbmc6IG51bWJlcltdO1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICBwb3B1bGF0aW9uOiBudW1iZXI7XG4gICAgcHJvdmluY2VzOiBzdHJpbmdbXTtcbiAgICByZWdpb246IHN0cmluZztcbiAgICBzdWJyZWdpb246IHN0cmluZztcbiAgICB0aW1lem9uZXM6IHN0cmluZ1tdO1xuICAgIFwidGxkXCI6IHN0cmluZ1tdO1xuICAgIFwidHJhbnNsYXRpb25zXCI6IHtcbiAgICAgICAgZGU6IHN0cmluZztcbiAgICAgICAgZXM6IHN0cmluZztcbiAgICAgICAgZnI6IHN0cmluZztcbiAgICAgICAgamE6IHN0cmluZztcbiAgICAgICAgaXQ6IHN0cmluZztcbiAgICB9O1xuICAgIHdpa2k6IHN0cmluZztcbn1cblxuXG5jb25zdCBhbGwgPSBDb3VudHJpZXM7XG5jb25zdCB0ZXN0cyA9IFthbGxbMF0sIGFsbFsxXV07XG5cbmNvbnN0IHVzZSA9IGFsbDtcblxuXG5pbnRlcmZhY2UgSXN0YXRlIHtcbiAgICByZWdpb25zOiBJR2VvY29kZXNbXTtcbiAgICBib3VuZGFyaWVzOiBJQm91bmRhcnlbXTtcbiAgICBjYXBpdGFsOiBJQ2l0eTtcbiAgICBuYXRpdmVOYW1lOiBzdHJpbmc7XG4gICAgbGF0bG5nOiBudW1iZXJbXTtcbiAgICBpc29MYW5nOiBzdHJpbmdbXTtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgdHo6IHN0cmluZztcbiAgICBjb3VudHJ5OnN0cmluZztcbiAgICBzdWJjb250aW5lbnQ6c3RyaW5nO1xuICAgIGNvbnRpbmVudDpzdHJpbmc7XG5cbn1cblxuaW50ZXJmYWNlIElDb3VudHJ5IHtcbiAgICBzdGF0ZXM6IElzdGF0ZVtdO1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBib3VuZGFyaWVzOiBJQm91bmRhcnlbXTtcbiAgICBuYXRpdmVOYW1lOiBzdHJpbmc7XG4gICAgY2FwaXRhbDogSUNpdHk7XG4gICAgY3VycmVuY2llczogc3RyaW5nW107XG4gICAgaXNvTGFuZzogc3RyaW5nW107XG4gICAgbGF0bG5nOiBudW1iZXJbXTtcbiAgICB0ejogc3RyaW5nO1xuICAgIHN1YmNvbnRpbmVudDpzdHJpbmc7XG4gICAgY29udGluZW50OnN0cmluZztcblxufVxuXG5pbnRlcmZhY2UgSVN1YmNvbnRpbmVudCB7XG5cbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgY291bnRyaWVzOiBJQ291bnRyeVtdO1xuICAgIGJvdW5kYXJpZXM6IElCb3VuZGFyeVtdO1xufVxuXG5pbnRlcmZhY2UgSUdlb2J1aWxkIHtcblxuICAgIG5hbWU6IHN0cmluZztcbiAgICBzdWJjb250aW5lbnRzOiBJU3ViY29udGluZW50W107XG4gICAgYm91bmRhcmllczogSUJvdW5kYXJ5W107XG5cbn1cblxuXG5cbmNvbnN0IEdlb2J1aWxkczogSUdlb2J1aWxkW10gPSBbXTtcblxuXG5cbmNvbnN0IGNvbnRpbmVudHM6IElHZW9idWlsZFtdID0gW11cblxuXG5sZXQgY29udGluZW50X2V4aXN0cyA9IGZhbHNlO1xubGV0IHN1YmNvbnRpbmVudF9leGlzdHMgPSBmYWxzZTtcbmxldCBjb3VudHJ5X2V4aXN0cyA9IGZhbHNlO1xuXG5cbl8ubWFwKHVzZSwgZnVuY3Rpb24gKGNvdW50cnlqcykge1xuXG5cbiAgICBjb250aW5lbnRfZXhpc3RzID0gZmFsc2U7XG5cblxuICAgIGxldCBDYXBpdGFsOiBJQ2l0eTtcbiAgICBsZXQgQ291bnRyeTogSUNvdW50cnkgPSB7IHR6OiBcIlwiLCBzdWJjb250aW5lbnQ6XCJcIixjb250aW5lbnQ6XCJcIiwgY2FwaXRhbDogQ2FwaXRhbCwgbGF0bG5nOiBjb3VudHJ5anMubGF0bG5nLCBuYXRpdmVOYW1lOiBjb3VudHJ5anMubmF0aXZlTmFtZSwgbmFtZTogY291bnRyeWpzLm5hbWUsIHN0YXRlczogW10sIGJvdW5kYXJpZXM6IFtdLCBjdXJyZW5jaWVzOiBjb3VudHJ5anMuY3VycmVuY2llcywgaXNvTGFuZzogY291bnRyeWpzLmxhbmd1YWdlcyB9XG4gICAgaWYgKENvdW50cnkubmFtZSA9PT0gXCJJdGFseVwiKSB7XG4gICAgICAgIF8ubWFwKFJlZ2lvbmksIGZ1bmN0aW9uIChwKSB7XG4gICAgICAgICAgICBfLm1hcChwLmNpdGllcywgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAodC5uYXRpdmVOYW1lID09PSBcIlJvbWFcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJvbWFcIilcbiAgICAgICAgICAgICAgICAgICAgQ291bnRyeS50eiA9IFwiRXVyb3BlL1JvbWVcIjtcbiAgICAgICAgICAgICAgICAgICAgQ291bnRyeS5zdGF0ZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5OlwiSXRhbHlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbmVudDpjb3VudHJ5anMucmVnaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3ViY29udGluZW50OmNvdW50cnlqcy5zdWJyZWdpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIkl0YWx5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYXRpdmVOYW1lOiBcIkl0YWxpYVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGF0bG5nOiBDb3VudHJ5LmxhdGxuZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lvbnM6IFJlZ2lvbmksXG4gICAgICAgICAgICAgICAgICAgICAgICBib3VuZGFyaWVzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcGl0YWw6IHQsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc29MYW5nOiBDb3VudHJ5Lmlzb0xhbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ejogQ291bnRyeS50elxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuICAgIGxldCBTdWJjb250aW5lbnQ6IElTdWJjb250aW5lbnQgPSB7IG5hbWU6IGNvdW50cnlqcy5zdWJyZWdpb24sIGNvdW50cmllczogW0NvdW50cnldLCBib3VuZGFyaWVzOiBbXSB9XG5cbiAgICBsZXQgQ29udGluZW50OiBJR2VvYnVpbGQgPSB7IG5hbWU6IGNvdW50cnlqcy5yZWdpb24sIHN1YmNvbnRpbmVudHM6IFtTdWJjb250aW5lbnRdLCBib3VuZGFyaWVzOiBbXSB9XG5cblxuICAgIF8ubWFwKGNvbnRpbmVudHMsIGZ1bmN0aW9uIChjb250aW5lbnQpIHtcblxuICAgICAgICBzdWJjb250aW5lbnRfZXhpc3RzID0gZmFsc2U7XG5cblxuICAgICAgICBpZiAoY29udGluZW50Lm5hbWUgPT09IENvbnRpbmVudC5uYW1lKSB7XG4gICAgICAgICAgICBjb250aW5lbnRfZXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgIF8ubWFwKGNvbnRpbmVudC5zdWJjb250aW5lbnRzLCBmdW5jdGlvbiAoc3ViY29udGluZW50KSB7XG5cblxuICAgICAgICAgICAgICAgIGlmIChzdWJjb250aW5lbnQubmFtZSA9PT0gU3ViY29udGluZW50Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViY29udGluZW50X2V4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGNvdW50cnlfZXhpc3RzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIF8ubWFwKHN1YmNvbnRpbmVudC5jb3VudHJpZXMsIGZ1bmN0aW9uIChjb3VudHJ5KSB7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50cnkubmFtZSA9PT0gQ291bnRyeS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeV9leGlzdHMgPSB0cnVlO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvdW50cnlfZXhpc3RzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY291bnRyeVwiKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJjb250aW5lbnQuY291bnRyaWVzLnB1c2goQ291bnRyeSlcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKCFzdWJjb250aW5lbnRfZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzdWJjb250aW5lbnRfZXhpc3RzXCIpXG5cbiAgICAgICAgICAgICAgICBjb250aW5lbnQuc3ViY29udGluZW50cy5wdXNoKFN1YmNvbnRpbmVudClcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cblxuICAgIH0pXG5cblxuICAgIGlmICghY29udGluZW50X2V4aXN0cykge1xuXG4gICAgICAgIGNvbnRpbmVudHMucHVzaChDb250aW5lbnQpXG4gICAgICAgIGNvbnNvbGUubG9nKFwic3ViY29udGluZW50X2V4aXN0c1wiKVxuXG4gICAgfVxuXG5cbn0pXG5cblxuZnMud3JpdGVGaWxlKFwiLi93b3JsZC5qc29uXCIsIEpTT04uc3RyaW5naWZ5KGNvbnRpbmVudHMpLCB7IGVuY29kaW5nOiBcInV0Zi04XCIgfSwgZnVuY3Rpb24gKGVycikge1xuICAgIGlmIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKVxuICAgIH0gZWxzZSB7XG4gICAgfVxuXG59KSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==

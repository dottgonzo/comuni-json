"use strict";
var fs = require("fs");
var _ = require("lodash");
var Comuni = require("./comuni.json");
var Regioni = require("./regioni.json");
var countries = require("countryjs");
var Countries = countries.all();
var all = Countries;
var tests = [all[0], all[1]];
var use = all;
var Geobuilds = [];
var continents = [];
_.map(use, function (countryjs) {
    var continent_exists = false;
    var capital;
    var country = { tz: "", capital: capital, latlng: countryjs.latlng, nativeName: countryjs.nativeName, name: countryjs.name, states: [], boundaries: [], currencies: countryjs.currencies, isoLang: countryjs.languages };
    if (country.nativeName === "Italia") {
        _.map(Regioni, function (p) {
            _.map(p.cities, function (t) {
                if (t.nativeName === "Roma") {
                    console.log("Roma");
                    country.states.push({
                        name: country.name,
                        nativeName: country.nativeName,
                        latlng: country.latlng,
                        regions: Regioni,
                        boundaries: [],
                        capital: t,
                        isoLang: country.isoLang,
                        tz: country.tz
                    });
                }
            });
        });
    }
    var subcontinent = { name: countryjs.subregion, countries: [country], boundaries: [] };
    var continent = { name: countryjs.region, subcontinents: [subcontinent], boundaries: [] };
    _.map(continents, function (cont) {
        var subcontinent_exists = false;
        if (cont.name === continent.name) {
            continent_exists = true;
            _.map(cont.subcontinents, function (sub) {
                if (sub.name === subcontinent.name) {
                    subcontinent_exists = true;
                    var country_exists_1 = false;
                    _.map(sub.countries, function (co) {
                        if (co.name === country.name) {
                            country_exists_1 = true;
                        }
                    });
                    if (!country_exists_1) {
                        subcontinent.countries.push(country);
                    }
                }
            });
            if (!subcontinent_exists) {
                continent.subcontinents.push(subcontinent);
            }
        }
    });
    if (!continent_exists) {
        continents.push(continent);
    }
});
fs.writeFile("./world.json", JSON.stringify(continents), { encoding: "utf-8" }, function (err) {
    if (err) {
        console.log(err);
    }
    else {
    }
});

//# sourceMappingURL=data:application/json;base64,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UyxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxFQUFFLEVBQUUsUUFBUSxFQUFFLE9BQU8sRUFBRSxFQUFFLFVBQVUsR0FBRztJQUN6RixFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ04sT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUNwQixDQUFDO0lBQUMsSUFBSSxDQUFDLENBQUM7SUFDUixDQUFDO0FBRUwsQ0FBQyxDQUFDLENBQUEiLCJmaWxlIjoiY3JlYXRlV29ybGQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcblxuXG5cblxuaW1wb3J0ICogYXMgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgKiBhcyBhc3luYyBmcm9tIFwiYXN5bmNcIjtcbmltcG9ydCAqIGFzIF8gZnJvbSBcImxvZGFzaFwiO1xuXG5sZXQgQ29tdW5pOiBJQ29tdW5lW10gPSByZXF1aXJlKFwiLi9jb211bmkuanNvblwiKTtcblxubGV0IFJlZ2lvbmk6IElHZW9jb2Rlc1tdID0gcmVxdWlyZShcIi4vcmVnaW9uaS5qc29uXCIpO1xuXG5sZXQgY291bnRyaWVzID0gcmVxdWlyZShcImNvdW50cnlqc1wiKTtcblxubGV0IENvdW50cmllczogSUNvdW50cnlqc1tdID0gY291bnRyaWVzLmFsbCgpO1xuXG5cblxuXG5pbnRlcmZhY2UgSUdlb2NvZGVzIHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgcHJvdmluY2VzOiBJR2VvW107XG4gICAgY2l0aWVzOiBJQ2l0eVtdXG59XG5cblxuXG5pbnRlcmZhY2UgSUNpdHkge1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgIHppcGNvZGU6IG51bWJlcjtcbiAgICBjaXR5Q29kZTogc3RyaW5nO1xuICAgIHN0YXRlOiBzdHJpbmc7XG4gICAgY291bnRyeTogc3RyaW5nO1xuICAgIGlzb0xhbmc6IHN0cmluZztcbiAgICB0ejogc3RyaW5nO1xuICAgIGN1cnJlbmN5OiBzdHJpbmc7XG4gICAgY3VycmVuY3lTeW1ib2w6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIElHZW8ge1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICB6aXBjb2RlOiBzdHJpbmc7XG4gICAgY2l0aWVzOiBJQ2l0eVtdO1xuICAgIG1haW46IElDaXR5O1xuICAgIGxhdGl0dWRlOiBudW1iZXI7XG4gICAgbG9uZ2l0dWRlOiBudW1iZXI7XG5cbn1cblxuaW50ZXJmYWNlIElDb211bmUge1xuICAgIG5vbWU6IHN0cmluZztcbiAgICBjb2RpY2U6IG51bWJlcjtcbiAgICBsYXRpdHVkZTogbnVtYmVyO1xuICAgIGxvbmdpdHVkZTogbnVtYmVyO1xuICAgIHpvbmE6IHtcbiAgICAgICAgbm9tZTogc3RyaW5nO1xuICAgICAgICBjb2RpY2U6IG51bWJlcjtcbiAgICB9LFxuICAgIHJlZ2lvbmU6IHtcbiAgICAgICAgY29kaWNlOiBudW1iZXI7XG4gICAgICAgIG5vbWU6IHN0cmluZztcbiAgICB9LFxuICAgIGNtOiB7XG4gICAgICAgIGNvZGljZTogc3RyaW5nO1xuICAgICAgICBub21lOiBzdHJpbmc7XG4gICAgfSxcbiAgICBwcm92aW5jaWE6IHtcbiAgICAgICAgY29kaWNlOiBudW1iZXI7XG4gICAgICAgIG5vbWU6IHN0cmluZztcbiAgICB9LFxuICAgIHNpZ2xhOiBzdHJpbmc7XG4gICAgY29kaWNlQ2F0YXN0YWxlOiBzdHJpbmc7XG4gICAgY2FwOiBudW1iZXI7XG4gICAgc3RhdGU6IHN0cmluZztcbiAgICBjb3VudHJ5OiBzdHJpbmc7XG4gICAgemlwY29kZTogc3RyaW5nO1xuXG59XG5cbmludGVyZmFjZSBJQm91bmRhcnkge1xuXG4gICAgbGF0aXR1ZGU6IG51bWJlcjtcbiAgICBsb25naXR1ZGU6IG51bWJlcjtcblxufVxuXG5pbnRlcmZhY2UgSWdlb0pTT05mZWF0dXJlcyB7XG4gICAgXCJ0eXBlXCI6IHN0cmluZztcbiAgICBcImlkXCI6IHN0cmluZztcbiAgICBcInByb3BlcnRpZXNcIjoge1xuICAgICAgICBuYW1lOiBzdHJpbmc7XG4gICAgfSxcbiAgICBcImdlb21ldHJ5XCI6IHtcbiAgICAgICAgdHlwZTogc3RyaW5nO1xuICAgICAgICBjb29yZGluYXRlczogW1xuICAgICAgICAgICAgbnVtYmVyW11bXVxuICAgICAgICBdXG4gICAgfVxufVxuXG5pbnRlcmZhY2UgSUNvdW50cnlqcyB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGFsdFNwZWxsaW5nczogc3RyaW5nW107XG4gICAgYXJlYTogbnVtYmVyO1xuICAgIFwiYm9yZGVyc1wiOiBzdHJpbmdbXTtcbiAgICBjYWxsaW5nQ29kZXM6IHN0cmluZ1tdO1xuICAgIGNhcGl0YWw6IHN0cmluZztcbiAgICBjdXJyZW5jaWVzOiBzdHJpbmdbXTtcbiAgICBkZW1vbnltOiBzdHJpbmc7XG4gICAgZmxhZzogc3RyaW5nO1xuICAgIGdlb0pTT046IHtcbiAgICAgICAgdHlwZTogc3RyaW5nO1xuICAgICAgICBmZWF0dXJlczogSWdlb0pTT05mZWF0dXJlc1tdO1xuICAgIH07XG4gICAgSVNPOiB7XG4gICAgICAgIDI6IHN0cmluZztcbiAgICAgICAgMzogc3RyaW5nO1xuICAgICAgICBhbHBoYTI6IHN0cmluZztcbiAgICAgICAgYWxwaGEzOiBzdHJpbmc7XG4gICAgfTtcbiAgICBsYW5ndWFnZXM6IHN0cmluZ1tdO1xuICAgIGxhdGxuZzogbnVtYmVyW107XG4gICAgbmF0aXZlTmFtZTogc3RyaW5nO1xuICAgIHBvcHVsYXRpb246IG51bWJlcjtcbiAgICBwcm92aW5jZXM6IHN0cmluZ1tdO1xuICAgIHJlZ2lvbjogc3RyaW5nO1xuICAgIHN1YnJlZ2lvbjogc3RyaW5nO1xuICAgIHRpbWV6b25lczogc3RyaW5nW107XG4gICAgXCJ0bGRcIjogc3RyaW5nW107XG4gICAgXCJ0cmFuc2xhdGlvbnNcIjoge1xuICAgICAgICBkZTogc3RyaW5nO1xuICAgICAgICBlczogc3RyaW5nO1xuICAgICAgICBmcjogc3RyaW5nO1xuICAgICAgICBqYTogc3RyaW5nO1xuICAgICAgICBpdDogc3RyaW5nO1xuICAgIH07XG4gICAgd2lraTogc3RyaW5nO1xufVxuXG5cbmNvbnN0IGFsbCA9IENvdW50cmllcztcbmNvbnN0IHRlc3RzID0gW2FsbFswXSwgYWxsWzFdXTtcblxuY29uc3QgdXNlID0gYWxsO1xuXG5pbnRlcmZhY2UgSXN0YXRlIHtcbiAgICByZWdpb25zOiBJR2VvY29kZXNbXTtcbiAgICBib3VuZGFyaWVzOiBJQm91bmRhcnlbXTtcbiAgICBjYXBpdGFsOiBJQ2l0eTtcbiAgICBuYXRpdmVOYW1lOiBzdHJpbmc7XG4gICAgbGF0bG5nOiBudW1iZXJbXTtcbiAgICBpc29MYW5nOiBzdHJpbmdbXTtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgdHo6IHN0cmluZztcblxufVxuXG5pbnRlcmZhY2UgSUNvdW50cnkge1xuICAgIHN0YXRlczogSXN0YXRlW107XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGJvdW5kYXJpZXM6IElCb3VuZGFyeVtdO1xuICAgIG5hdGl2ZU5hbWU6IHN0cmluZztcbiAgICBjYXBpdGFsOiBJQ2l0eTtcbiAgICBjdXJyZW5jaWVzOiBzdHJpbmdbXTtcbiAgICBpc29MYW5nOiBzdHJpbmdbXTtcbiAgICBsYXRsbmc6IG51bWJlcltdO1xuICAgIHR6OiBzdHJpbmc7XG5cbn1cblxuaW50ZXJmYWNlIElTdWJjb250aW5lbnQge1xuXG4gICAgbmFtZTogc3RyaW5nO1xuICAgIGNvdW50cmllczogSUNvdW50cnlbXTtcbiAgICBib3VuZGFyaWVzOiBJQm91bmRhcnlbXTtcbn1cblxuaW50ZXJmYWNlIElHZW9idWlsZCB7XG5cbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgc3ViY29udGluZW50czogSVN1YmNvbnRpbmVudFtdO1xuICAgIGJvdW5kYXJpZXM6IElCb3VuZGFyeVtdO1xuXG59XG5cblxuXG5jb25zdCBHZW9idWlsZHM6IElHZW9idWlsZFtdID0gW107XG5cblxuXG5jb25zdCBjb250aW5lbnRzOiBJR2VvYnVpbGRbXSA9IFtdXG5cbl8ubWFwKHVzZSwgZnVuY3Rpb24gKGNvdW50cnlqcykge1xuICAgIGxldCBjb250aW5lbnRfZXhpc3RzID0gZmFsc2U7XG5cblxuICAgIGxldCBjYXBpdGFsOiBJQ2l0eTtcbiAgICBsZXQgY291bnRyeTogSUNvdW50cnkgPSB7IHR6OiBcIlwiLCBjYXBpdGFsOiBjYXBpdGFsLCBsYXRsbmc6IGNvdW50cnlqcy5sYXRsbmcsIG5hdGl2ZU5hbWU6IGNvdW50cnlqcy5uYXRpdmVOYW1lLCBuYW1lOiBjb3VudHJ5anMubmFtZSwgc3RhdGVzOiBbXSwgYm91bmRhcmllczogW10sIGN1cnJlbmNpZXM6IGNvdW50cnlqcy5jdXJyZW5jaWVzLCBpc29MYW5nOiBjb3VudHJ5anMubGFuZ3VhZ2VzIH1cbiAgICBpZiAoY291bnRyeS5uYXRpdmVOYW1lID09PSBcIkl0YWxpYVwiKSB7XG4gICAgICAgIF8ubWFwKFJlZ2lvbmksIGZ1bmN0aW9uIChwKSB7XG4gICAgICAgICAgICBfLm1hcChwLmNpdGllcywgZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAodC5uYXRpdmVOYW1lID09PSBcIlJvbWFcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlJvbWFcIilcblxuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5LnN0YXRlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGNvdW50cnkubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZU5hbWU6IGNvdW50cnkubmF0aXZlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhdGxuZzogY291bnRyeS5sYXRsbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpb25zOiBSZWdpb25pLFxuICAgICAgICAgICAgICAgICAgICAgICAgYm91bmRhcmllczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXBpdGFsOiB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNvTGFuZzogY291bnRyeS5pc29MYW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHo6IGNvdW50cnkudHpcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgIH1cbiAgICBsZXQgc3ViY29udGluZW50OiBJU3ViY29udGluZW50ID0geyBuYW1lOiBjb3VudHJ5anMuc3VicmVnaW9uLCBjb3VudHJpZXM6IFtjb3VudHJ5XSwgYm91bmRhcmllczogW10gfVxuXG4gICAgbGV0IGNvbnRpbmVudDogSUdlb2J1aWxkID0geyBuYW1lOiBjb3VudHJ5anMucmVnaW9uLCBzdWJjb250aW5lbnRzOiBbc3ViY29udGluZW50XSwgYm91bmRhcmllczogW10gfVxuXG5cbiAgICBfLm1hcChjb250aW5lbnRzLCBmdW5jdGlvbiAoY29udCkge1xuXG4gICAgICAgIGxldCBzdWJjb250aW5lbnRfZXhpc3RzID0gZmFsc2U7XG5cblxuICAgICAgICBpZiAoY29udC5uYW1lID09PSBjb250aW5lbnQubmFtZSkge1xuICAgICAgICAgICAgY29udGluZW50X2V4aXN0cyA9IHRydWU7XG4gICAgICAgICAgICBfLm1hcChjb250LnN1YmNvbnRpbmVudHMsIGZ1bmN0aW9uIChzdWIpIHtcblxuXG4gICAgICAgICAgICAgICAgaWYgKHN1Yi5uYW1lID09PSBzdWJjb250aW5lbnQubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBzdWJjb250aW5lbnRfZXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvdW50cnlfZXhpc3RzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIF8ubWFwKHN1Yi5jb3VudHJpZXMsIGZ1bmN0aW9uIChjbykge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjby5uYW1lID09PSBjb3VudHJ5Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5X2V4aXN0cyA9IHRydWU7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghY291bnRyeV9leGlzdHMpIHtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YmNvbnRpbmVudC5jb3VudHJpZXMucHVzaChjb3VudHJ5KVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBpZiAoIXN1YmNvbnRpbmVudF9leGlzdHMpIHtcblxuICAgICAgICAgICAgICAgIGNvbnRpbmVudC5zdWJjb250aW5lbnRzLnB1c2goc3ViY29udGluZW50KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuXG4gICAgfSlcblxuXG4gICAgaWYgKCFjb250aW5lbnRfZXhpc3RzKSB7XG5cbiAgICAgICAgY29udGluZW50cy5wdXNoKGNvbnRpbmVudClcbiAgICB9XG5cblxufSlcblxuXG5mcy53cml0ZUZpbGUoXCIuL3dvcmxkLmpzb25cIiwgSlNPTi5zdHJpbmdpZnkoY29udGluZW50cyksIHsgZW5jb2Rpbmc6IFwidXRmLThcIiB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgaWYgKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpXG4gICAgfSBlbHNlIHtcbiAgICB9XG5cbn0pIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
